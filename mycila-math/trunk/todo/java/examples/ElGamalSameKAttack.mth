t:=NEXT_PRIME(2^200)

;Simp(#1)
1606938044258990275541962092341162602522202993782792835301611

p:=2*ITERATE(IF(PRIME(2*t+1),t,NEXT_PRIME(t+1)),t,t)+1

;Simp(#3)
3213876088517980551083924184682325205044405987565585670609523

g:=ITERATE(IF(MOD(i^t,p)=1,i+1,i),i,2)

;Simp(#5)
2

a:=1897456254164942343917965235766273117568497123443633417036846

r:=MOD(g^a,p)

message:=30249875309285709328759302875930285709327590347524096346

message2:=9238652389765892365982365826589265892569823659826892659823

k:=2388424515437026664851549783676880762378680269832085250306583

c:=MOD(g^k,p)

;Simp(#12)
1642888020851138839985143747652209853264823298182518021833998

d:=MOD(message*MOD(r^k,p),p)

;Simp(#14)
2423699272959365071299919696965347809128019098341877537393147

c2:=c

;Simp(#16)
1642888020851138839985143747652209853264823298182518021833998

d2:=MOD(message2*MOD(r^k,p),p)

;Simp(#18)
1394500791523696367305442526712905312818729871045966459248084

d2inverse:=MOD(d2^(p-2),p)

;Simp(#20)
171164269300021014098269930428606194139335616620654362864166

messageregained:=MOD(message2*d*d2inverse,p)

;Simp(#22)
30249875309285709328759302875930285709327590347524096346

