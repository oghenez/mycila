/**
 * Copyright (C) 2009 Mathieu Carbou <mathieu.carbou@gmail.com>
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *         http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
package com.mycila.math.number;

import com.mycila.math.number.jdk7.BigInteger;
import static com.mycila.math.number.BigInt.*;
import com.mycila.math.prime.Sieve;
import com.mycila.math.Factorial;
import static org.junit.Assert.*;
import org.junit.Test;

import java.security.SecureRandom;
import java.util.Arrays;
import java.util.Random;
import java.util.Scanner;
import java.net.URLClassLoader;
import java.net.URL;
import java.io.File;
import java.lang.reflect.Method;

/**
 * @author Mathieu Carbou (mathieu.carbou@gmail.com)
 */
public final class BigIntTest {

    //TODO: improve perf to match those from FactorialPrimeParallelSwingLuschny
    // -server -Xmx1g -Xms1g -XX:PermSize=256m -XX:MaxPermSize=256m -Xshare:off
    @Test
    public void test_vs_apfloat() throws Exception {

        URLClassLoader classLoader = new URLClassLoader(new URL[]{new File("lib/Factorial2008-full.jar").toURI().toURL()}, Thread.currentThread().getContextClassLoader()) {
            @Override
            public Class<?> loadClass(String name) throws ClassNotFoundException {
                Class c = findLoadedClass(name);
                if (c == null) {
                    try {
                        c = findClass(name);
                    } catch (ClassNotFoundException e) {
                        c = getParent().loadClass(name);
                    }
                }
                return c;
            }
        };
        Class<?> clazz = classLoader.loadClass("de.luschny.math.factorial.FactorialPrimeSwingLuschny");
        Class<?> clazz2 = classLoader.loadClass("de.luschny.math.factorial.FactorialPrimeParallelSwingLuschny");
        Method m1 = clazz.getMethod("factorial", int.class);
        Method m2 = clazz2.getMethod("factorial", int.class);

        long time = System.currentTimeMillis();
        big(100).factorialPrimeSwing();
        big(1000).factorialPrimeSwing();
        big(10000).factorialPrimeSwing();
        big(100000).factorialPrimeSwing();
        big(1000000).factorialPrimeSwing();
        System.out.println(System.currentTimeMillis() - time);

        time = System.currentTimeMillis();
        m1.invoke(clazz.newInstance(), 1000);
        m1.invoke(clazz.newInstance(), 10000);
        m1.invoke(clazz.newInstance(), 100000);
        m1.invoke(clazz.newInstance(), 1000000);
        System.out.println(System.currentTimeMillis() - time);

        time = System.currentTimeMillis();
        m2.invoke(clazz2.newInstance(), 1000);
        m2.invoke(clazz2.newInstance(), 10000);
        m2.invoke(clazz2.newInstance(), 100000);
        m2.invoke(clazz2.newInstance(), 1000000);
        System.out.println(System.currentTimeMillis() - time);
    }

    // -server -Xmx1g -Xms1g -XX:PermSize=256m -XX:MaxPermSize=256m -Xshare:off
    @Test
    public void test_primeSwingLuschny() {
        for (int i = 0; i <= 20; i++)
            assertEquals(big(i).factorialPrimeSwing(), big(Factorial.lookup(i)));
        assertEquals(big(21).factorialPrimeSwing().toString(), "51090942171709440000");
        assertEquals(big(22).factorialPrimeSwing().toString(), "1124000727777607680000");
        assertEquals(big(30).factorialPrimeSwing().toString(), "265252859812191058636308480000000");

        BigInt fact = big(99).factorialPrimeSwing();
        //System.out.println("99! = " + fact);
        assertEquals(fact.toString(), "933262154439441526816992388562667004907159682643816214685929638952175999932299156089414639761565182862536979208272237582511852109168640000000000000000000000");

        fact = big(10000).factorialPrimeSwing();
        //System.out.println("10000! = " + fact.toString(16));
        assertEquals(fact.toString(16), "46ab3ae48966202d0fde097bfa88fadc512ae8afc0ea1d1d376a4109f10105e9e21f1e907151e85f926b8d82737b9030d572715fa32690be8dd16867f348b981683cda4be4f9e259977e69c16905ecee567d26742c1ba1cdfdd1274a067c3b39020f8d500f1199aa73884607e93fe423a99f3646585b76278922e3583c349cd3368417a0e630a075839ec290393d2f669d948980b23bb114fac5d62ac52e9883c9e3b8e0cd6bf0df411911f40d9f968f8691630a6033e9972c3090ed2c0ecb3a3d8ace0be058877cbb7e2bb8e9065af1d1eed955881cfa5ab0a4e155f84311203ba7489fdf5d08cac67c97920e676fd54a972b0297285841d9ee665dfff40bf3f162cc2a4ac74be168d996eadc9fe38b406af8f23cad528527097e4247c49d52aea83abfd77472110ad2dca4c977e104e041386a942d62e362e968b12bfc2549a5a3cefe5bb6b799e97d12f047aab8e219751f940689c3278e3e64583fbc3ad07d44745bf43feb42a8b7a860906dd98a5eae125fe7f3a013383b23331796878a2936e276a021f2fae759567bc8a261a4f1b8967ca3dea6d54ff6f97c97c791dcaeb6dbf4bde55bfaa1ceb679941675d1863a9a730e380099157bc0887a09e4b3d255dea2ce3fcbdaab5a783d0c60dceb7be6194d9ae7dcc515c4394cfa8b0fc765ddca6c64a5fe82883d6d2340f71ee3ca84f60339742b3ba82b5f05ecb540fd7e9a97c0a78e30f26307137efaa9aff7d462bc617e6ed6b9a9ec63728d4cd5b1a7f6fea10db84925e948df375d23ef6f7d912bf9c9af213874975b528b10fe2b791b39d1bf875d01a65b3c17d97ad2fd2eb5adc8a8a4b9516024e92a37ed14d6f087c5b99ac523e7f1157817eae88373990d19998b0a412e8add60b47f61ffcd2336bc3c137857c698be679024789ce95c19199b13a783f56a7e15ac38e63155a08337a9d4305cf94548f6788ba19af84e2c25578a346282e907c3380200a1acf5c43ef3b974da2a962acca9caeb1bf88e1c4d91d1f38164a360cb6f5fb48b8d18d9316023f1bfa0590c4a68a4fc49d4a17ac7d96dee097b3dc5c9e960636fc9a8c6220e8f3d6d0d7a79dd8861263a876b4b16b749c4ac6b4dc708d08f20acf42cbf98b7f4b9ece0f979d35f2c1dda29a8c313e23dddad30013aab39b415a058a2043350ddc2fe9ae3c66171fc1e8c54f59e53f734388a013b449ee0dd9b5eeeb432ecf6e60c14cde94916e0154a2baf84a3165a28ccbbceb5017504673bc32da530e90c8d074dc6f2071c36042d41f8decac8968a61445097cacf98fae342ecfaf7f567eb7ed8d11486c5c5290da57b6058d1799ce94330dae1e672954e134fde55d5629aed6f499ef81aa7c8dbac75ce7a391f23a0ea37cfc1509090e5d67b3989a6d01535e083b499bb51b2338f598ce2ad3f3fa614c2ca084442230989f8b464af87bf519287198f75949eacd7c245eb00f1fb2b055932fe4bc6eb0f7d6520030d93ee1feb0ee237a1114e6e60a49f3bf5fdff37c3a136ea5f9237d194efa6a7d551a64325d4708e784755cbeb0326b906df2161b5438ff1f91db3a60318be09b6c19ce0b8bc2f5a8d11f5dbe8f4a8c8ff47beb5cf58ebdaa03b69d29d6ff0c68115b753faf65deb98d2568867b18081532da2159c817d0def17c0edf7194300dc14f751694964043934a350eb0821a42f8a651e4b66fd78dca89c89d1f8d1c12f30a87f4307c58da161dd92214ec84fc4b2846f6e8265497ebd458c19832584fbf09437df477fde4dab76e8a5e45b78a23961a305d5351e0a9335cb4473d8b8b4e4b08094e93063792cc1364272cf4df8953cb07302dd1bcea4b8da10fedb4e201fd24fe4d51df15f9681fa9138784167981b3ec1f2d1ddf31e441cb7706b553053348e79670de2a3f361c84aca5ca4c582d19ddc3431961929f21ca5d5dbfbce6004da1e1f43d44273bc5e9f7ef49048bca2752a37c586aa46f75c3556e40eb317671ddac982869d64f56b2d43e249f75a9a6d1cbc653fd797b3cc455e0ed6a9b50a8c9520390b14938a545bf5345d6ad4e1866ad9e97d054508a6e427f008549813a94d979f5f23ba1f7978569f16a65fed6be7acbe5c98ade564e6aa6cc142fd7b66298c9d4c336521d324d5f077935cc1399d886cc10abdc65534915cd91cbc2dfb0306bf73d81f4ef0443e619e40b031ab33c9960553ea696def99741c478a0ca7fc5803e47bdf766bbf3013ea912fd3b0aa35d223ea524ed2ab1925719d95b9dd9091b328a2333f50ff66f3320fc45a88855f82cafdcfab6d5a63249080e513974003149b5ec731740ce5b0479092eedb086fc3d31aba7ab3abaad48605e37d5e82ad82f3fb34d97be49437a7349671b730ce1c8be8b4b7ae36323c240efbbf98ec3a90e2ef496e4e1e1b028db99bfa5a8933499205543522715230a86afda04348d7e8b7702d15dd2bd96d7c379c507a0413d4e9f5878b55fea0b08aaddc25b4f42a76d3ae788f6ea6daa6bb7c3bdffede9016fecb1c11759f061784127c7da411a7da6515a8fc32d60a9bc91bba213bc7c6de230ca5ff5eb23a759fd2876817c42ac700b938fca3d0cf04537858c05552d15a90b8097f9dabfab959360f0b28e3709610060f4df935282a025b0d61c503220b69582beaeeab70843c2c59585d8b8c705975064c26d6540afd294b4b4a05a9053d0917b0fcdbbe6b85f70bfc801758222402f44303d562a841ea945c7bd52c464942738dff502183b9968fdee9c14f72f1143f2ddb48c372aaa8301e89ec506ca67b412548375a53844742fb70fca23796e3ddaf1b0472cf2addb4ef0abe6691e00bc11b637e5e819895deb4bd02431785ee0286f544578371e9829993524d558886c6607986e7b9f113ec7068998a173bf8b045b0585d065aca7d20d71b238215c7dff981310e21c6ebb4753b34b506776967a0234c1efdf988f4028e015c6260be9a69d8330f71081a36447faf7ea5ed5f9fab1255e4ac5b935ff77a58aacc24ea6a3881b75137377df9734ad197b9e4db8dfc6e4bb56ef57b13c196e064b34e4e53c0dd3986a2238965b1fbae3d2cbdd5f25f6060f48867b89e848bbe0f58a103c496697c07e6eb15cd1aa946ed19b79b178345db2b04150a73d0adec11c73675a7aba51582b460d89bc5a32aaed5694540ec894a9a574588dc97fa84bbdc03183b7172dd380ffef0d87fa96d1048d475f8008d8ae72484a9bfd04f8863844365d014ff0acda7af8f8ad80bdf7289abbddb4c7f6aa33063c758638afe3c0c92f4502c32b41c5b0dd556590cc4823805ca76f6a98c675bedcbe801ad0d8eda46a842235096235d29d11b2528e5f135cee19fc318889d0aa32985fd15c2fb32df392767fc3c50f2f793432a07ffee46fd84e98cb1b3ea2cfc39feab6f285429be0378694a3100cc79e3736bf815df3941133f752bb1f004dc2219c303301a2a8cf82c082563d4a93c9ddb1f9dc81d48020c8c012e9b1428e2b1df6086c2652801ed0df764ec439939843af56d9b57aaf5b3d271114be8625cc012196e0a212e84731f510fbc65709c29ec95271a562d8a0b29792e304558ca06875505c13413a6408fefebc8af202e1749abf62fecd8c7aa9fd2645e8b9a5984c42a99fade37e44f25e5fc8bf9642e1a87e0307ef779cb8e9e78459563e96feb51826391b1904277fe8f817ad0b01d6f8c76658843d4465bdb034ab84497ec0bc0e10ed700c01c51283fabcb3337f977035f5678dea02687ab0e6bc300111f788db415d4fca2d74aa8e5a1fbf7173cd4b6ff754a87cfaafeab973ecc0234bdeee4f15f8209f029d9e92d9040650c7c974e033c1a27c94e13bc7dcf16c9968b12ff921eb40124abdc99bdf9790eb802aaf89dafff148ec9d85d7ec90130bacf688e47bb631b69bb7a26fba906867cf665df8e8b0f4f5fb5f52607f07843a02ec44c88adc563724cf225e831169d7f1aacdb203faccbc589c3ee39235b246758319185a16c729bbceec30eac34c5b6c14b20d9ee7253c43c8925b5b04580a50ac16ece44329c369bbef09138186d0f5d866c93445e8fea018618ddff8024fac522a6e2aca986eb7c2a4fc9a7a76694ff136124eeae14c33413457063f7187fb4a95aad2b901aa5a37b08eb3d08e6404f27e04ca044d6ea1880a06596015213ab62eaead531c16a25b470f10f5bff2f5ceae0dc455d8d0b16a320b3fd1c43e4d23b77a1538e44f085293aed9bf9ee0f09a3a9dab49fd884760ac4838d644fdcaae3d43e3dac8cfe109d061052030c21eea94fdfda541af578bcd7177df332e2d6a5c24930548679a9b7991049d33249fa188e5d48b7aadb2081453f9cdfd633789f5f8508d0584c2d99876c913ead946c9c7f927b541e26ed87c9aaecbb147245e09062678eb4feab8913fe570b3b59fda8aae679129cedada0e258d697ba4a44676dc457998321f2e99bb24957433f4de842ebdc3b29c00691ff56c0293a15dc05e72c01dbbd1e836fa990e83820f4ab1800e0864fc430229baf0593c9690b935dd19958c1ec1372479dd89e738f553a994003c0d716d0cf6ee13bf24f9ebbfac05226105f210e230f75a60c919c0cd358b08ff280b85a259a68d916b507f0ac6c11b4f13e3bf70a2e0be9502030e308a12f3e42065e0d119fa7ad365df0d40240e04449f3618a64750d7be318122d0a58d943dddd57d1b95da2e6c42d955d0589d35a5c912718d79fc98e451b51271163026139d57b534d2f847e766999e69e0b5724b7ccb665d10c3cd8fdd3f56ba2adf83ad11cb7debbb8f699e432fe89b97abb7dbdc7877616d2a6dcadf6b5a1918479bb0bacf2717aab4ed45a77be27ae4d07d934a0e805f43b961c70545aba66e40b463104168d693f87418905ceab9b9433455564d4cc6eadb867cdc3008fb5554fcb9f254947b6b6fe2dd03a499eac56bb20275bef9b4e680a5fd9664a61177ab24588bdb131134cd3cc919614459796f2a387f903cff1a7cd91d31ad12deabd1081f116891dabc228a2cd7c2684aaedb49aa19cff2a68af4b08bdccc7417d44233884d68e47d27986c381b8fa4346906363e21e0e403e35f17b109b085b45c8ce32ca30f20d31c71050304b5be00617fdfce24d273a9b88e37fa9d2a30705387747fbf1e2ad21130ea10c652ec3a08b9414562b3b6aab2e2255e86d7125d063517441df00e4c2d44528ef32fca26c30a3743488691ee3a4ea4d3ff747c62a43d78912a13bc778943b31d154a4167b6b1cd0a826633ed39496d3d773b0c6869acd6384c4f31c531288ff5a46656bb33ea9122b269c4fcc9ca7b8cea33025f62703fe5cfe21a7f2c1e7346392d06e8562e8d119192a73f20fa7b458f30900f277c49ec0b0ffa82e158c5600a655b2863a74d24a245ac7c1be0bf0e3cc9ee15eef5ff6e4202fb837005cce72d678dc38d41cd04f5224ca9b7e15d640e2ddde831da01f70f79c38f865cfd1d0ec1fe9dba06085ef99f55571fd236a4d5a4021186a2d7c493d97ff957e2d006572f31932f324a4e49dbf63e306dcc8ac43aec139d505f3e0f815b9ef2be2340d3aad5e80ad1881fd1d28237cd2f40cc92106e607cfca4176543bd4bd5108e47bdf33383dc72f3c18e59fe5e6fa6a5d364a3d882b77deb70c8889fc9ae9f6c84bb6ecb1c2ee936c84b0785ac45d301b30cf5d4c438571a8d64849bbd99d934cf5b1561dc2bea6c2656eb3787f87ef872eaa59379faf661cffeb3988ea725eba5ad2433e43381eb052b20a1014a26aaf45d471722a632da82ce5f5063217353b6bb9b07aa657abf30f1557f2de74cc2916f4c44941942473afe31946d7f58999343e3a2661f2f22533b2deb5a1a04abd257c01038575dc79b29b7b7b8f265b0691fcb9bcbe1313206e0c95d22258d8f18bc01c9aa8c7f08cf3555ddeb3c06b30b9794d80a85518a84fe1a2d2845d66f0aec9c148dbcc2cf687b40e1abbb5d3edff42f4821fe73440f5412451c3f191ec8aea7953317cb4e0820322e5fc395abc83be3e85fae54ec77b1c7dc6278918c3bef9f9ebc4a46e1c5f68922044b50942eb00d981253a2eee3821954d534bb60dff4c7dfc6ea796ef28371db88303b23ae012eb85bd1fde4361782181cc57b18f95e841d87f31afed1ab5fd8562dfa2ddd54e0fd7344eb6120f767821decf414c8cf02293bd351d4f7b297a3b58c57bd8fb73705922bce5dd8d4c32fac0f06791c76d8a85e08d19bf3739cc6c62f77431b6f264d98c2a74a87f9c9519612ca28cedf14eabde3732b9fcb54befe49ded72691a9fe75e504f856441f7e55d4ff1f56d36774106acd0e7a7203704e4fe5ff1fb0b61ab765090001d92692884a41b3ec9d416f050e09ae9c277308ed872ad7fd6d13ac276c9c80ec92ca00fbeb3b8cbcb276224740bd1a49b456b6620eda9afd5f3c0d107377f5ad0dc2159796eb36480cf296bc6915c53d2d7dfd763e0ba0d24123e4093c7d5575c916cbb053356dd91229a378338d467e3f52a9a79ecf3aca1d0234cf654278e9e5add18651c08d6671ce942e16ff782db772f4f2660c583fd6409de2aefd2bacf1a9d69a5ccd45d747fd28159d26a09c017f3c5c17eb25d4b1d406eb8e57f63178fdadd5d5459cc27b7c79758fd9e0dacfa35b7bcdc1c131faeaef6e7a4773551ccdfdae6afa29eb62b2d5c13a004ab5332dd8aadd891a8ff858044caeda2010f08350391d65a5af5804d8686b233699fa59f5a8f8150d72a099cee5fba38fc1741c00867efad3676c2b10e86bc781b0adedb847d80704688787b67b91c17bd80a48b44634fbdbb448ad71592b525be28914fbf171ea3b21cc1c4dc9480f44c4c130625a781856c42825ccc186c689a2b0244c17f71d1173ebe9fcfe0b3cd02e567476294eaf606d85878a8e79ad6c784718528131e8c7407f6139cc413a7e8af3ade39e0d9b21051d4e9d9c96da56b6c19e3a9cb183b8d4276aba1e288072bddfd2cdfcdbfcc2d764c10e8eb246a5198aa32589b12ecfaabf19903976935437d546aa5948c1c99afb48c9fd137e325541a2388fdfe10eeef0326b6ff9df84f6ceaf0eeef036f7ac5b5937c4bccdcc836e63520b9db1d71e741c3574bda69e75455d3aae9a28166f4cf7aec8e2cbd39cee6cb8f83c7a4bac99ae51728da436fa3560d102a7cf77d56bb3fa361945d7760bcdb35bef5708e26708f847be6e1fd34aef155ba46eb8e3a99c759e11e03b4aef8be536affdfba72608a39cc825a5732ce170acfa863e801c41aaf911a1edb0ca460a0f609db69b797e669e45e3a7513349e8450bda1d725b2b7cd2cf97bb4dbc2691a2ab4ffeb8ff7a9b9b42d9d3d1f4b40f05c02979357029c93c706153ca19bfa5f2097ea71d695a08566e71802f6212a11b9a8273892494a6b4ba6562b1636187f019eadc23955eb84ac47d0832707a81a1cb73105cc592dd665d4877f93446849cf350a2f049c437160ef4fb3afac228c905e67dbd69c737de4082cef3af1508177ec57e6127526d19bc6231517f2a17d291309709406329b96f4fe13e3c8af3f299c1868063a6608d26315151a3c1c922fb4cc41641bd4935171c3fe5d08abe9344ad126e7eec9a7e13faa0283a6dde54be2fc6c7917ec029fafbf1e35e62563e6d02f6cd40cd4e207697ab39b915e2954440dcda72836b83340fea34b25791a22f5d92a89c5e144b8979be83ed9855e744c34286a8ca5cccfad486c2342e6cb5004061d7583097ddd88a0546f3afc76e585a556ce38d2c5226e35553e8521e60f68e09f946eea2c2ddddd3332e70bce5b7c363a725df279277b240dae99f045ecc96d96f34a2ea31c5724ba3515e5d3e12c5d1145a4b2a0b2d5c5267b9a0505acc2907d8f2053c579311410430695b863147fd89c148b1e6e874049e99dff17ffee22dc9d5ecae98f517165d57e84777fed0897346b2e2321749ecdae78ab111555796c0ec5fba8f1dca54176bc4e3caef6e1b8fe677f85ddea2763ddce431db9cff719515325d9b14dfe6bbd7dd58a39263a2583d1b96203e4a86b16af5be494c4557f88490150fe2863ae12df9366674b8e55ca91e37771a90587ebcfdcf518108501d241ce8af6cf2343f06ebe88692480fb24e8690886c6ebb9518578f6971c558f887b3860d58468d6a54c0d59b1a913a8714358c779bc9493cd66d814a431675c7fd3126fddcc2ed2bbd99c5a95555525b2e4aa7b147173e5325a6ac23788d71341c87c33dc14598896ee067c9e4f26b9e56d9a43d30599b1f0ae6d670f42f1e8246102e3ac3e66ee24ebed90700abae2003214fd3de924bb2cb0b5e5988cd91a784b425781463910e68ae15b9466d54b5458d9ce76216feac1ad86ee53a1d52896b4bb1f0457fc9fef894dfd6abdb671fcaf5f2d9085ace8909e9dd5445a0f59ef0cba872cfc0941f9a71d4ec9fb64b8cc626a4290d2d031e008012b5d6a25e0d5d4de574230c585859eacb962c9be39978c2ee7359b2b59ec08565f7cb398b5363327bfd0d78b8865fbca3898a5d1d52a4a6ee34448c452aea62d7da63d80f93ad6e45c3bfa928880e25c0689c50d9a58a1bed660aa59dccb8789606339efa899c6242fb69b5f27f9fd9d1c4d2923b3d6e99d40da26f6f0477ca514b41eb413633d5afa23b1fd20845fba729c14cf32b3dba9a08dfcea29ad11eec4a87f413b57729c398dd04b39c854b6140f4ac71602bce1f66ac270e323a23bd6e3c8555583d2e5609ca6a597ddfd9672c7fe843cd6b43734b895368306bae1951c94d8d9b811a4c34ef5e4663e3acf1723f82ecb4361473e960f8730a0b44df4f78b89c938e83a9b99914eca4fc89cc345d53366d040920dd3649a867e0503c586aa33f7751196621c62475c97dfcdbf66ed18a26937391f22c183a9046ae89330102ec8bd4d44b2c1f866184800acf6ec936d712469830cfd0e715fcb6047575c0fef744443f960005b8cf76d72eeb754f91798a4587aebd4632d4baef76b0765ca0467eb0a095a8a6584d09f467209cfc2d26fac23fd864f38e65babf829ade897b1b851da66c2a9911c2bd8854c4e986021d0cdb18e82c245d683b512579c872f169da25ce018fd782b640c71ab5879c563a7f94817f3dd4942705a5d7902b78d84ab1eb8c6f32999ae93693f93605d93128f0d50b23515caeb6779eb5e1bf2206c3a7b2ac1fb571d97a736cfa4c5ab51ff0103e858edeedc02d437dd7df13eab9ca65f18b5fb8db7b872e88bb33a5713f484943efce65254e148c1a73c07453d26969c4c57c94b949933458f33739a3d4900a5e0a04811c283fe95347f6a31635fcc6dc8d7af5f411f36849790526efb109928e62a6cc9f06322c656b43bf5cc5717ee8f642ef05093e965d3902ffdf6083b4202972a9479642bfe0ee385cfc41fe807061392b5965098702edf8b9c2c7f304fb98c2c72c655fe362ae9c4aaac92ee5ad6d2a801fa28e962bc5051ad8a7e96df5c9183dc90693a1a209a5c92b3cc1158c28e1050a2ebd4141a103292654f5966b3f5c2996a7d1a422687fa374c267db1a25a50d19c8e490eb4da70b935df48be33ff6b9246c6021eb060135a32a40c2bdc6ad52da78bc628a4bb4d4de626946b098dc4399d6c6ad26e15e15e1995f6a178d2806bf82df301d4592371e17d46ed0283ca752bf342ccd3efdf0addd78fdf6ccb25e78114ce0bb28fe4686322eb2437202b330e59b17c34e39c02d4dbbf78f1be15511406b52dacba7b6482dd68809ee6f44ed1c5718bd0607fd46c828dc24707e6d103058dbb0e6d86012430cfd4a6d8fd579186cc46e51fd551adf7f02c4fa1316eaa8a793e33c6ecb5761fa6c1e15da8fdee5c4ccc90fc0c305df18033b169dd4fbdabac0786ae1b088066c269c2137b4f189750ee1c7c84064b4aaff510a087e69d88c9c39e18ff75077c8971583b9cd81aaed88bfe7386b894e00db13a9413c6bcd769919a6d16a41de83973b49fe2fadebc6cd1848327c6312f9f88900c988030d153b3b9c6214a5e9e2d9700c844f6ea72f0eee53b4e3de6b1e9078a9cf29c503fe8d8f2fd9ba85793cb16fe33b5695202c397ec0fee7bac0cfd1d303ce6f8d424cb6082e54d81bb0f8ff0dd660eced0f8e0a5a09e5400fb5b1fc4d309fa9f05b63e5ebf7ff1f5061f3d5c3514fee1254794a29dab5112a9477bda6ff75e86c61216ab6d16ac2ea32b8042115b3249f8ca49ce0541e13c60ee7356cf60a6a70722b43b33073c656e27223be8e71e8725b6912ad5eb4cb9153c424828224d2a91ed8a6be78c2029465e3df9810451954768807ab4ffba41c5e4cc6257ccb862c0ab85369db0f3545eb681757eb88b6f9829283c9f95946c4a35d56f66a9e85d12c66f6d0049e5aa8adcbf66512a83779a14a6ab64ad18d39d158253e1e6214c68388924adc08bc2e09721136906e77c60f5ad675f466385f76c0e028587835279cd8eb5272a5ca98077809c1fd023aad238c9a3b452f1a73a677582f8c9d1143db75f879b1d3e9d007aadac05f7b64b5ca98d0cb0156b75b8e2bc30b58397584f0501a62429a654e58353af8315005b50192a54aa7f84fd233e09cb33322040c22fa31b97f1926661959cb7046aa905cc2e783ca7333b5dd1ebb2e48036e11a66327d154f8a8686d0b23863bac33e4cb2d8098423a440b17259824c4b24c04a27b9326afd94b718110072de3fa95a646aa051cb050829fae50f0cd3f9c00329a7f170f555a4e8b36640d01f6d443fe257b553af510928cd3ed5e5b61444f64a65800a322a3baecf41ac3ac8ee3e56dfcce208cf1cfa3c00cbc935f2e04c746c3212767b99da2333b949d621387524c6900dfb3c81a321f7bf364747484eed0492fa53ada6d83b5f808c8ef28ec1a86ab3d48ccfa27c65bd5c78bb61a2ba2c009911813b37464dbb780dff4bc70bf84497201ff9270b5360fe755954cccb6b3646b6d6c93d1f0abc524beef628c095ece27e48ec3f5bd948f1fdbc5dcded5879a34ae862279c5fb34f15ab3bc66d9d0c24a9b4ecebc1fc99d916ec64a153bfe0d97067af1e991d012a54c6ba830c7ebb95838f9eb4c866aafc7a816047c1729aab34a9a85fa7fc9952b676c85e468287810de1cb65fe554287580d9bb6e7b6c4b108113013ce0f21fafb4731601ee25b027bed5ba4ea9cd284cd5348fffa47fbc36e3ac17fa0ba2ace9740ef0bb9bbf687d151e2ef3bf8aa86b4888abfd0cb6b797a4788e11488f20c1d7a767e6d4c4b2f351bfd749ff85ab2f6d5eb913a925520bc7a81ff78d5a7f6397c78aa4fdf9d677429ae3ab7444680c5e7e928d36ee2cd639948b74b053149ae0f89f884adf95b2581cad66071b988af45beb92c556c8bf870b6b0c5f744ba31b4e4c5faac45b9aaf08beb8dda565b653ea6038d547f9e277492ce0596063234b1e0ba98a1f0cda3e5a450135b0d454918c8649d049965d79b17c246daa0eed1bb7f99726448f4c16692c9a3dd8aea1d55b34b796ef23d29cc004c4950dc79e2a038a360d78b1db2a314555d7b74f34d1a5c4096dc8283abb9a75430abc9113c3445c47c43013ba67625c2f857714b8c825cea5dcbd9b5ce33c73edcfd62d13b705eff0d51e653c00434e47e1c28da114033f0bbe03ffbc81f9db41a9513299342c3d2734c445ca43e15800c0e7b61ed765c3c94ed30ea94cf95f14ab58120052d7002717eccb528731857d73d4efac2a80bb2289b8b1020290ca0505b54f9e8aa6cffc10b52fc40548b279f7c187d520e17e0e9155afc33df4ffe034faa1a61abc6a6748c6f5f54da1e9ba3433ae470849793d4f2721ae0a8646042a4469fbeb22e801446d66fb878ec9cab4f3806d43b472331db1c6681ac64b3f1a06e501c9e9927c06ea064e7e8000d6fe954dca772ef9cba71c7319a15c7d8df920867527fe6686b733c59e72500f139cc82e52799018f7e8cb6f37b64ab87e66863ff12dc3bd3e00a3442e69c7d3f176e0a1d51fe697d221c8a499e0185fd2d342110da11e430605c6dab0239ed0ad399281e9864d8acff1f1f80d44d36cb3a7ff11b7d9d0564c8c3c0cffc7f2bbd036e3ee6316f7c063bbf8b90c8dd49dceafc6b06a4911ef8ac2be209d245d5288e80ad9b04532ba47ae888239b07a4ea1b39812c4304ca22e0cd13638022ccb02923b8c787169df3d54d177b81d87aacd518f118e9bdab589abe93113f03c31a5fd1c237258523e98e62d33aafbaee238b9fc6118d198a977169bb3894b8b9051283549f968eb983c440e0ac26e62e6aa4872e7ebdac7c6eef7440e75f94a857bea674419cc76f90a9f95a80df90a0ac14d03bddda89b052131a1bd8d29e2ef09424116c88db97db1c929a730c6ed0701130020389f558ba3328673f1f30e968bc36aa08ba10e82c441851d7a595f7c531094f072a61b70e84d4b51fc5354c3a6219c810982366481e4c4212047d09aae0aec1e0a22c3e826873c96bb54da8525e58cfdb465af9525eb90ca9091641b0dd30bfcc32ac2667a951861a0a48c974a8829fdb2b100c07f0aa9afd7b512b7604f4de407f7d0d9c1465ace055885a97eb9e9beaee9a5dae4acbe3c290098995fea4685bbb54a0d29ea15dbda44ae6b305994d121125cfb2cd33e2f2c99b90d24811c363f37b811b26c5f85ab1455a4591ce649d5186a775573fa2d466a4f59a28bc265bd7415e5a06c6473c6b5b9db901f7a7faffcf64ba002a9d3634439f5b710f674c3191a26e344ecfb8439135fe7d5f9da121e9d141ffee2ba498647a6c4dfe330cf9e16389149bcc478865dded2f5225ee2ac8eee78afce5b62f36d926e0d17d0b47a2a36235559b5e15625fd40284305878c4ea25e18ceb27bfbf24857fe13f29a996a4cbf6b384c06d88501f452cfbf3d807f96d08bbec387f8ddab442e80741492293915555ea52c44dc84b698b496bd80e977a8c69aad2d045c2f83668dc98d989e305c446a6e512037755d87312860fbfd48ee1acfc496320a749e3253c1629432ad905b7eb92aa6b41476ae60edd178cc56a7b63864642d38e3311e5d249ea23d1c3bd1743b02fccc34aa488495c5b2caf1408c42b7bbbf5e68dab9f74dce918a9e224338a1b403f07c26a1a1a5d43a30e387f7b3f68ccaf51fa2d52ec919c75419dd647ed947f7a76f5231e6764b05ae0477e50bab26c070aa2788ae5b2078ccd520a2b63c5e72374aab3793912e1ea906c472d831f4bdf71dee8fa2b545809264c101d62951e5728dc39b2d1e0dfa803b1dbb8a478786f35c825c6aa52c67ef7516c5278e1d43080ea59d77f4851a94d50b31b2160e95b60a6d8c53936202bbf580d48b1b1497244c9549fa0b5985b4809d8a50b0ebb314482b46f0f3de81d6be7ebb8aacc6e46d78a4a146f2ba79dead8757bc383e09bca5924709f3f834b20786a215fac852b20d6120bcf731852c2a459116689d5c1a863396adb2ccc368848954c3206bf2615cac62fcd95d27405f32eb6042a98e0ee87a1704284dbbc173b51f96b4264740fb1561f112893a5fc3477a161b634ceb8f4385c96d0839b4fad22c1dbdaeaad3405afbb13a4c6b63208f3018492f1f65c33922a824258998fe4ac671bc33676fa26bc9335027df743993f62702ae2943a2e5887e64802f8c1e425b9945c98c99843a8343cf705866fdccff6a42011df33acbe61d200598951d921f8c5377075876163372d558ff7e26e0c9c758fd62a7edb0743b55b864ce66ae124883eedeb54bf87dca99fe685e05f5cc18793044e5fbdc87ccbb6bccd9f3f6933b0898250704eacbd5bfbb2100b23bfec478741e9d345fa54b568d727854ed920e16e757a47c7c36816582d4b0b69eb28574eb167360988af8c549ae17b533368f035a37864c73664c94027949f4386228ffdfc03fd3775eb90249a10df5651795e63f2b934b109ffb48f8b4465e8f8b89bee2fd3db94c19c4d269f8dc8cf60acd897add04dc7e14e8eb4d8588795eb28787fd40681c4d26afb49116a713b7680d2c45825b58747e8ffbb7dd9456ad9721a17d13a84022c227b0cec4ad9bb15b5b30f786e0b0ffdef7babd2135e4791fa30df1c8504f9db232d9267396b82fd658558523002814f4fbe14eaf4d502b5167b2f1d5c7e0cd7b43938ee3a8de668bb7261c07140e6e300f9a7e782ad0822a5400132fdcb037d679527d00ddc416a699bfca0d1e1e75e458807a3d95ca7eaba0d6606791a9446806a052dfca2c16fb504296c52cdd30bbc376d2943ca3f30564a37923a4d66316b3ca97a34e7e898cc839f764b8bfa2a977f7d0e516c4e3d1e010f84c695d5ad3faa1bfe209a8067060e7d3f2df20abd6ca9d9bd945c26b6b19ceab7012634697937dfd47e6e0ed5d031773a1a2b48b12f020f5e529bea36a085f4c5174bfb2020d012573231cd849854180954896f021759a944a4138c53340a508e7f4bfe5db2fda6f8d7770df4a77e58358a646b33ae0a2567492a356c2d85f32d1397430170e05ed1f94534bfac858387d1dd489cdfe875854f9190e1f1d265461cbe9c489c02e2729509898abde3e9e33644fb828f1a577c357042dbccd3b7dfebf4ff5850c449f7580002e864fd5dbff42142485b52a77273672e5970eef51485080d09d7b8f18f53000e63b322463390030e31813ea611fc988f5d9ff17ef56c87834f7743b456ef634fa9ec9961dad80506bde195a7ff8e45b2bc97732487dfd8a2bcf7c0efb7c9d3a2f903a29ad0c25b4135a94efdba9cbd6db56d12371d2bdcd0798c76e51522a630e1bea9f0c6643d3d171dbb0136e2d142c870d41b59e588832e20db2cd33fe94870a1e06727122a8917676d7e9b9604351a6d5929c1228b87fbb6e702d1df7b70a0a106d142a686985ccb88cf7724a059967c60c7821c67095d99bb20620b83c44d85647e5ee87f440193ff2712d7a4f2fdd7167f036ed09496bcd75a5d80fad2420a1556f1b222548bbf623bcb248ebf0089b025b4e43e4cf6fa04adda2448b3c5f037107cdbb64b7a779e0eda16ff3e0752a6790c68b0662a4c2368a994aae2856988444e5fb641983f38764a4375c1e5f2d71472462b390a91815cbb361dd7a09e91ddefa283914c3db7a7b2d4d39722d6c8e7c0df25c0681ecdca053c7049f5513eec948aecbcb750f710b2f60363d8bdcd5ab89021a35621e8109a3a07ebc648add14475091a9e18730573e5b84f0696198cd4a331fb8898dca94ae293dd9dbcdd46fb4f83ddc9898c626f1384578d2026ad7aff3ec5291f502224aa9037a8d12f49db519d3ce2d08b844e824e2f49a6db73d8b926760c2197f28f8914e3435e9418173782a9c549299192609d7dd399ae5ccc0238defbc8479799fb0d2334e3aceba774599a5b305cea49d493da522cba400f7c0f360048718e2132c8de8a7d9af1d4e8bf320a4a1137f4b35743a676db799cff44d42f9f01f1f509580ad4f6e2e4e74d11480da66537773b0316a8161420a74b92d3c484b9aac6c8f627f555515a44e5a173d8d1578f4a4bd563f856162923bf16b2e30297b99e0a43b03f20be7cf3b042fd449cef279f31c0f17fb002ec9211d47dd4e3df4fa3920716f4f17141d0a7085ea652477eda5efe7f4079f4cd71e8c691f60b9c9aa9b0e5fb6d5367642c4c3bfaf6edaeb4bbc79294a4c9875b1ab6702f2b98e328be732a7709714ea30fc1914b80b220671e0d272b88d960793ba3c4bf59b83e00c67b19a9a648955f4a4391ab8f9f69dc425e1f2505d499b2e2452b15f12f8c2217e87e9bded9ec58d25490cf2298b347b64e8d937651b3197e17f82e867a9594c88df9d7cfc861cf3a1a5c7c263cf65765dd836061949077eb1cea0251a7ad46628ca46069f5438ec75278acb3d30fa0db064a8f4283477fae64863162979b5718de0585cb21bd0ec6cc8f6fd0dab37318b648df49f8f67579cdebea18d4a8aeb9050cbf0ddc5eb16ede21c9ed2608a1e5b4accefeeba463c5b198ac0ff49229b7eb039846473155f1005645894a39f6e1ab51b2e3b87f586d8d3c38ff395525a817c8ad8d59e066d66706ff5b6f09e273c9a598dab6032746819f0b9c6cb76b69d75c2a03f4c8745ebd5490898a0483f950b047384e2310ea72b899e9a3c5b00345c16721f64882187dac78dad0ca1705b0b423075847ef2a477e91323c4a6f0d33f359b8ffd4ffa2f56d1f33e8cdb84cf2feafe4c0d3fce79ec54b9e9dd7356a0faf12fa78e75006c10122fb44d3ed19d47c3051b8c4c445c623a78bd4edc30b378a8be503098414284c808818df9b1a5553ed49acf0302878dfc6a876cdee06af197cb766532b2554d5d2a78472f4a6b78490809d3ee9788e07efdbda1a6c37f3441f9e8c0da66cbaed367714e40649ab7ad376b0798a0cec386e84342f5a8a730e1472545eb8f4b58cb5b24eab5c9eff1ed72a9645a9adab96e1d4300dbacb0a2e3c95a0dfa7d301aca2c8bfb1f64ef2b65b28d6303f253da5edb3f789e0e759dce59332197e7c05416b6342c0502b4ff731b716a73d8e95d1fe0c8c4e13e57ed31c32f8b00ee79843c40337d8b03a1d7caa3ed25b35f7e1a50e8ffb7da2ef42f7923eeba5d085f422b490eb3ebd29751b9e3864e01ccec9a0f78b5383777d7abe50a79a788f93219cd9546b5b528b6da673175fba0c8f497bba25eed660743ad0cc76db8c4c587fcfd2282bb596a3dcddcd71a3597dc8109d946e5a275e69a595905c89457c57e18914c289fc71443e7aa69b7731a27fb51ce9ea73ea37143bec5416f5c2f004912ab5de9856970bc4160c56691b7a6ce9ba97a9723ed9e45daa2f2adf39bd3bc0ffb9bc890147a39aa982a5cdc496e34389cd5f57df6c397c28474dcf5b55b7a5a52e504efd312b6e5e93fa1dfe34cfa443814d2a93b9494e64e6f9b5ba984a32823d8b7a6d24e191e29cd7ce8b96c58ca7de52dc51083f898c7b00b4b8a791280c3d1c226520722e4287844c0d629632a5b1d8ed722d952ddc117887b5c96495124cf6cc26bddc282b7de876c1d0aa9046a7d447b9943ab068bc52ac2f39f6d80fd837e0d0bc7efd5fac76c0d235c0b4b5bcac3eb69ee1ceea2fa3e9ca45cbc30871d64c80f664f008c9a7808247343e9f88f44e135079166e7085bd2bb6b06bda132bd2f319363a9961984de3062d62c36792d4ab3ff170bcfa5fdb101cf5d65d62956c9ac0e80c8a62c3143bde74b271c042b347a6fdd64ee02bc90f3925afc993689cc40acaebc45c8784a148af4a4c18231d3d8202398e04f38f19fe10e836a706880c10b82b8a84920f1de969fcd2b24b2aa25c8c8fad01e8465e64c37a657e77b8cca9cfb49e8d8ee3d51df258a514d1364aeea79d5061430ff93a08c6ee102bed3b661865bc159edfb9d7d6bea574666b922c702111fc27a02d710fd9860e9e8b27f8db180fbb6e175e5e60fa273246884ec0591a353abac75eb28724244583d58cf8f1608a18c1afdf29b3eda92254e3fe22c726191f174e1a2c526de6d1b92299a41bb495b29c0f4e81eccaf87034a6a78c57e8e033fc994da026da623695ae39ad73e7e1bc247842fa6d06bcb2dbbaf11764368a041d338ac30553748dad4c62cbbfc6c032c064c2782d27bcdb44fa2e86b805bae549ef2a6bf8c68d6f2b3267d9b77f1b81d24b6ebee42cb35ff5f639ee4dc138d053b00f4ae71cfc998512dce05f03317996a6d4a787fcd619a52bdfff1446c0d8f96d7021f589a82c2860de4aeea62c661276dedaaace58538d278de51a8677a44a24b4d7c5487f80d3413f841b3d02b2f7c590ce4fe84c783404d6a587385f9a0f7cd57918db136766c4ee248b0006bbe94bc9d7f9c10b3df317e1a5e45f101a367d8543115388aef3efac2f49953df5b58b64746257cb3e8db2f8408f9e695e340dbc90458089c87b7a71635b1ab94cf061f3f540128a0b7bf0a1d0afa8a57030c3c41ce6db5902fa6cf4d16965f942c418ef4558c4ef98051420d3c8580699f3679770797cfc6ad7c2a17636c5ec201cf483aaa1196e42ff90d0f8516cee152a7b50fc19afb80ed0b03973bebb7ef3bc4d0b75613b31d60aa821e3be410ae1bb5329b5f98006aa6cb7d7e9856492c1d106e05989083f24471d480a09b0472fcc3a20d99865f53f1d56edaa4c2c38cfd457ad561ee229baadb3221cd27232909043eecb5698d4cba6695191d6af7918acfb929fbc14577bef688ab404df00c15b1965fd930277c2b959ec1c747456da64e6ba719d9b426c654142fe008dc7c86729a0e68189ca6548eaa29f9cfcb189ad0911da879b7a0995b3836a1b5778b185ed518ffe59f173530af0fd7a2522cf939a9b97e8b03a5376c1099d373b99fe8f9082c622cbcab33e5eec492558265857418b7a08f505ffebf77a5f4ea71621eb216b2c49ba85d9daaae490ba0181db4338d8d3753251395a683ea18fa2fc81441c3edd4c289c4a009b5404b41bd97ddbdf619da7a012495754cdcf5089c708fb8125e9a5fb306d9d192cf7ca80a1d0b373862df6f514f900de3259292d68c2c31311bec941fd933ba6803a1c258a453c5528d66e7300585abe75ecd65f33ec1c67118e03351b2d2de692d80edd4780bba8f9c477d4b2d1dc75dcadd5a21ffc40bd00f1cb424654f492f6cfc5b1c75dd83e3a5964243526e4acfd505f23a31ca8dd7e3605efb3ec4c8831535bbbccc8e3ceca3ca848ffd163fa25010cb787d4bcbae58cf904514b06329667d21ef42419fb49e009cb6574bb850540e1f848010134842cd09f6717dc4ece7b9d4ca09c1f9ad40ea3f212677e5f9b10e28ff870b597753426cd0743cacbe3e6e28718bf20f31d79ff1f08e374b19eaeae30a1ae97324f3efdbf550621fdc915b9ec409a30983bfef2b3e3b86b38d39a985b2b4bd98b19758760f80d74b0eae01ba8381ae29a8f8fa5dbd4ce3b16b56f6bc72000edeeae8c5d863b87b88f532deb8a2302625d05c6abc1b970da583253dd662669f21fcb77463cc6c9f30f85c3e73fe612885f791882f11abca9c6796fe1d39478cc83bdce0268e63f748cf34db669536b0d9e8fe93e2b5b869abe893d2f3c7491a3ee098ece52145b244474291e3a1d0c50bf2cd7b722f98e6fecfda6c0f4f7557996cd71ae3a6634aec3b221393ea234ba007a76ae86df800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000");

        fact = big(1000).factorialPrimeSwing();
        //System.out.println("1000! = " + fact.toString(16));
        assertEquals(fact.toString(16), "2a2a773338969b740de6e2b291fd8dd6ee62a2b41525ab61cbe52489b6cf344c23231711b6d9f34e0f13ab50eaf1ad3dd92771ec26b4b9ea80411c866b1ccbd855f8326edab10832755e1682d3e7a91335e3670329bc1571b5208d72f7d6be81483a6e6708abf913b789f41838e9a73c1ba82e3a956570405a660a17e1125838bc810c8d2c63915481914ea202867a563a41b6aefef5feac300a78803a30eb995208842ebeba8729397a8cd9087e28fb155a3de0f18dd90e64a9293af6487a5aabdab855fa254fcbdc9f1116060bc2e2b4410e55e7368b844d9bf0aeca92deb017def69af777e8d4edb1f1b926ae01df3366abb9e4568fc08fe255b68bca0e48382a8e6df1c7b0ba33bc2225cc512b39176a26b13098e733e51417224be36fbd933a8a7d98a08f356cf010f0fc59b9f1e32d3fb43209a82fa0e7f69e302fcb0f20362b86cbbeb08b81b1ba07f08ab119ce5e092d09996b710588779327d91ee80eb679a99f0fdca7eb4a50ef174295e94d590e3cf8bf37d23e5b22dcd79a4ac2c1ea7d1d55170789fcd2fcbb3ea52ead4f7116f862578f5e22421c90cd0a7ee095903150631f27305191429a54cace66dd076c51a94034b31bebec406ee460181225e03a9a22c51e6a2a8db4a94fd352605115caf251b14df0cec523c48b79b58b0fc0676792d38a0d61523eb75f5cbc33ebda1b19933878ce7050356bd228ce9327a9916f9ff3bb5b6beedfe5382b861d6c4da52a9754b6feec8a99372b43afa7808836d281c5b2cdf791cf76d6c737aad32c5ed7475855fc15c3f45c4705dd0d6b4078656d027cfee6f37772e03c35c0dcbbdaa25ea64d6865c87cac0a9a999eb88d7a16515811a77192071189c353c1e72242a4f3106cef2bad1075549b4efd6885690f3f58c1f4686951cc543118428ec653e3c6fbdb427930f624680672c1e70c25db7e7b67016a95b30dba56d0083759eac93a8e4d0c54853aa43f197b96fd70696ae5750d7d1f0427b8dbcfafc8b9924d51340fbf71bc22780fba76525f5e5b91a2461983b60bf087dfdd89dcbc6f7892d9e4c5d55d106d45f77e4fc1c44a376d693bfb8b160f12ed1bdf5f4f1127e61d9dec2dc1bba43a6ff47d294de7a67cdf3ef90937667092517e985642d195031c6f5339c1cea607a699c55e75c5479cbd30ddaccab307472aa67a6a9a547d7e1eba123144193e6d2933556ddeb516151eacf0b48ce08892236abfb74bf0cee3a0e45997301027f2a53990697694f14de4fac0c908eeaeedf3dbb45c4ce9f744fef88ec1068c52056b16da099e1fb620bd90de25534b5e820b367a400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000");

        fact = big(100).factorialPrimeSwing();
        //System.out.println("100! = " + fact);
        assertEquals(fact.toString(), "93326215443944152681699238856266700490715968264381621468592963895217599993229915608941463976156518286253697920827223758251185210916864000000000000000000000000");
    }

    @Test
    public void test_squareKaratsuba() {
        SecureRandom random = new SecureRandom();
        long time = System.currentTimeMillis();
        for (int i = 0; i < 3000; i++) {
            BigInteger a = new BigInteger((90 << 5) + 100, random).abs();
            BigInteger c = a.multiply(a);
            assertEquals(a.toString(16), c.toString(16), big(a.toString()).squareKaratsuba().toString(16));
        }
        System.out.println(System.currentTimeMillis() - time);
    }

    @Test
    public void test_squareToomCook3() {
        SecureRandom random = new SecureRandom();
        long time = System.currentTimeMillis();
        for (int i = 0; i < 2000; i++) {
            BigInteger a = new BigInteger((140 << 5) + 100, random).abs();
            BigInteger c = a.multiply(a);
            assertEquals(a.toString(16), c.toString(16), big(a.toString()).squareToomCook3().toString(16));
        }
        System.out.println(System.currentTimeMillis() - time);
    }

    @Test
    public void test_slices() {
        assertEquals(big("ee48e04b60b1b6398431f92bbbca5854c362350", 16).slice(40, 0), big("854c362350", 16));
        assertEquals(big("ee48e04b60b1b6398431f92bbbca5854c362350", 16).slice(40, 3), big("ee48e04b6", 16));
        assertEquals(big("1f92bbbca5854c362350", 16).slice(20, 0), big("62350", 16));
        assertEquals(big("1f92bbbca5854c362350", 16).slice(20, 3), big("1f92b", 16));
    }

    @Test
    public void test_karatsuba() {
        SecureRandom random = new SecureRandom();
        long time = System.currentTimeMillis();
        for (int i = 0; i < 3000; i++) {
            BigInteger a = new BigInteger(2400, random).abs();
            BigInteger b = new BigInteger(2400, random).abs();
            BigInteger c = a.multiply(b);
            assertEquals(a.toString(16) + " x " + b.toString(16), c.toString(16), big(a.toString()).multiplyKaratsuba(big(b.toString())).toString(16));
        }
        System.out.println(System.currentTimeMillis() - time);
    }

    @Test
    //-server -Xmx1g -Xms1g -XX:PermSize=256m -XX:MaxPermSize=256m
    public void test_toomcook() {
        BigInteger b1 = new BigInteger("8634518bfb33b0049513076e5911b2973c3c639db1576ad607f2198e86716c007f618fd61a47d482cbcc49d9429d3d7aef9cd0eb3b50d7f35fb924534812dc02d13d58ab5bc3f40a07fb29b6dd5c6f1f5536ce17366a5cd7e395c5f2561a83c9d9eb12eb9a65e6b72143a0b5dd57ef5653973251fb8a48433d0c91f3ce7ab7096d565bbe27ec229afe69a759cbcef7205345ae1bc415c27c975ffdcc35b179996f401e5805533c98021cc5d3e6b051622e8f7782b266353838a7786169bbe22f2be412c733474d62ce390bf0762e2fc284dbf633c6c45767327608ec9ef8290ff116710d9a4807caba6065b2bc656a83ffc72f4f9eaf8f13bfeac86f16182cd22034327f7cd9cb48995ebf5a08c3b9ae759ee2e900f5ae47e847be7f9f1efa6358edfe518b92988c0cf845e017a5ebbff47f9634695de6358c15a31da27a1aced1b1ffd6cd89a2f418c4c44873bce828a439d74d4c90653f55248db767ddbc8ad98d4c02df94897a4b82efb151f55f81723d9c2fe8acf93b792976ad3dc44863cfc5e060cbf49ae8e6aeee11cf39f3bd03762a04950c56afc3b1c5a8219c6549749b9ee14b166518f97f0d7a68fb061bbf0c864927c4b0c193942124bd42aa759ac65ef8777fa8f1d2d45d0a5ab1631cbf10e481e1fa5460aef7fc3ff40ab3832d3926dd4f3e2da5540ec6abb3ed457e26fe8f08944437b1e5a2e7893f85412a3f75cb4314d48513ee840dba5993162e9d7a984543949585d9327e76578d0c6f551c47260c4702ff5b30d1658a2b97e4f928c8c6ce9a5371029dbd18456ba79f6d788c84ecab695c0583559ecfd56ad71bf7993b27c821e3d81b75dee7bb9ce8c4fdcd7bb03b4b0e7a63a670f89d1604990372839b807159ac7f2a9a22c63e243acbb87eeba89dc81c5583a5f9885c7e215df37636168b9", 16)
                .multiply(new BigInteger("6fe451309b29f1751e9cea1ff56ed241f4a256abfffdc6ac55644a3d8e7c87d2310ca4717de5d2cfe6b910b50b16a0530db246efbc67ed4113d7d593e4c8a529009e64124faa067345c4238b67e61a8e97663d6dd1628545a9497432eec1de4dba05df67095b12255d5b9a182393c0f5131a8b1c8244ec683324f5f5743101cb2d5170dd0414bb99b48fff2e45145542238ad4142f5327b51d7df572296093245d6c86fec8be5e7488031ca2c7a7624b988e6ecbd2a1bf0c50bd0ae1234275b07c77ad663f3e70c8edce1124c7eda172d97a913e15260bc0e6b810e493bdb8e112439006a165f8c7344349e6311ba42a5297081d5edcbaa021fc166532f55393548e21926fa092269c2cf326cdb3dbcc7c84a2dd4b62faa76be7ccb0e2c4784fae806f65963765a5668ca1ce704ed259648b554ae03b7065a855d33f3f0a99c464778f772c5355ad2d4d2ef735819ca15fb966486469a1f6a48e5d14a22491f7a41d8db07b8033b9eced21a1f9325c92b282a410db2394d0f5f73ad00eda4c6c23b0a105dc476593a2dc8af7d74f947377cbd0e4f82c9f2f95e12339842c26308ab81911079bfe1d2581f812e119b7a1c64408c9fcfc6962efb186f0dcde86acf0a502d08eda3e8f7cf76ab3d65fa6b4db70093aee269dde1f175d0b49d69761ec933bb03e1ab5ead37d46c666197bafcb5bc1991f9f475682f00c2e4bd9afcdfc0ecda23de644e38fb983c27de91dcd5290e62296c16f66a2218329284f0d1acb2e7bd4c30094eba95089a049ae6da27d5ce9bc2f134b2ca55c41027a3d1bc31a1813eadf90ead1568", 16));
        BigInt b2 = big("8634518bfb33b0049513076e5911b2973c3c639db1576ad607f2198e86716c007f618fd61a47d482cbcc49d9429d3d7aef9cd0eb3b50d7f35fb924534812dc02d13d58ab5bc3f40a07fb29b6dd5c6f1f5536ce17366a5cd7e395c5f2561a83c9d9eb12eb9a65e6b72143a0b5dd57ef5653973251fb8a48433d0c91f3ce7ab7096d565bbe27ec229afe69a759cbcef7205345ae1bc415c27c975ffdcc35b179996f401e5805533c98021cc5d3e6b051622e8f7782b266353838a7786169bbe22f2be412c733474d62ce390bf0762e2fc284dbf633c6c45767327608ec9ef8290ff116710d9a4807caba6065b2bc656a83ffc72f4f9eaf8f13bfeac86f16182cd22034327f7cd9cb48995ebf5a08c3b9ae759ee2e900f5ae47e847be7f9f1efa6358edfe518b92988c0cf845e017a5ebbff47f9634695de6358c15a31da27a1aced1b1ffd6cd89a2f418c4c44873bce828a439d74d4c90653f55248db767ddbc8ad98d4c02df94897a4b82efb151f55f81723d9c2fe8acf93b792976ad3dc44863cfc5e060cbf49ae8e6aeee11cf39f3bd03762a04950c56afc3b1c5a8219c6549749b9ee14b166518f97f0d7a68fb061bbf0c864927c4b0c193942124bd42aa759ac65ef8777fa8f1d2d45d0a5ab1631cbf10e481e1fa5460aef7fc3ff40ab3832d3926dd4f3e2da5540ec6abb3ed457e26fe8f08944437b1e5a2e7893f85412a3f75cb4314d48513ee840dba5993162e9d7a984543949585d9327e76578d0c6f551c47260c4702ff5b30d1658a2b97e4f928c8c6ce9a5371029dbd18456ba79f6d788c84ecab695c0583559ecfd56ad71bf7993b27c821e3d81b75dee7bb9ce8c4fdcd7bb03b4b0e7a63a670f89d1604990372839b807159ac7f2a9a22c63e243acbb87eeba89dc81c5583a5f9885c7e215df37636168b9", 16)
                .multiply(big("6fe451309b29f1751e9cea1ff56ed241f4a256abfffdc6ac55644a3d8e7c87d2310ca4717de5d2cfe6b910b50b16a0530db246efbc67ed4113d7d593e4c8a529009e64124faa067345c4238b67e61a8e97663d6dd1628545a9497432eec1de4dba05df67095b12255d5b9a182393c0f5131a8b1c8244ec683324f5f5743101cb2d5170dd0414bb99b48fff2e45145542238ad4142f5327b51d7df572296093245d6c86fec8be5e7488031ca2c7a7624b988e6ecbd2a1bf0c50bd0ae1234275b07c77ad663f3e70c8edce1124c7eda172d97a913e15260bc0e6b810e493bdb8e112439006a165f8c7344349e6311ba42a5297081d5edcbaa021fc166532f55393548e21926fa092269c2cf326cdb3dbcc7c84a2dd4b62faa76be7ccb0e2c4784fae806f65963765a5668ca1ce704ed259648b554ae03b7065a855d33f3f0a99c464778f772c5355ad2d4d2ef735819ca15fb966486469a1f6a48e5d14a22491f7a41d8db07b8033b9eced21a1f9325c92b282a410db2394d0f5f73ad00eda4c6c23b0a105dc476593a2dc8af7d74f947377cbd0e4f82c9f2f95e12339842c26308ab81911079bfe1d2581f812e119b7a1c64408c9fcfc6962efb186f0dcde86acf0a502d08eda3e8f7cf76ab3d65fa6b4db70093aee269dde1f175d0b49d69761ec933bb03e1ab5ead37d46c666197bafcb5bc1991f9f475682f00c2e4bd9afcdfc0ecda23de644e38fb983c27de91dcd5290e62296c16f66a2218329284f0d1acb2e7bd4c30094eba95089a049ae6da27d5ce9bc2f134b2ca55c41027a3d1bc31a1813eadf90ead1568", 16));
        assertEquals(b1.toString(16), b2.toString(16));
        b1 = new BigInteger("b2de14ec2ee993ba535d885545df0baf38f4c78390bb0a92ece9259243234dee3f2842d45330073a4c6689b7f8559163ab9426a72b8d840d7b3d212e22047ab39339c49ed377f5d420e7eed6c4f1851057420359d8a5cb4b2cb8289eba16ad1d4a955e734906260929684f4aaf5993fa4d7de1e993cc19714e81b4fda93c55c728be745a112233de6d9b5d3bc9824af6dbf62c35854b1f19f936d0b0a33602aed41f396590127037b9283bbba1f392f67a4f10b750dd73aec210a46509df5dd3ed708ba8beb7503fbdccdc3e71bc65cbe9daaf5d115df6f7e0fc5ded1c6d9987fd635169135042a995c0a85f5a359478daa41331ede052bbfa2829283777d9503f1b672e70794c04d863304e509720896bef9d78a264a6ad1d106aac87715d7a653894bc1ed62f2503d0f471a6b1b9a81d9b2b28ae7a975efea557bd3f49a440144365d89fb909609ff980e9976eb9fe31ffa504bfec651e2966c4e42e3955a9afc09fda96892f326ad1404359b2c3fb0349c74548a39a92326e880b158846f97091345da31779f4033d857e12d564db60b90be31fb7bf516ac22cfd8e43781b288514407cdcfc9c681c2ef3f4a9267542d4166168dc70cd1218b25b0e741ab96b21ef52099e5881f20b9811bd5e65727afa6451e2e9cb9dd6919e0e4465b6d6a4abb14156ef3823c5f8b05a9bfe907188e7f63c46eb94635bdf29060eb2cdd9d692f9e3c7001002f7bb2c8b5d9e7891d8175377b05ad55a279755c9e37da820fe6a387a5efbea8617fbe7c7a30b734272aa95fb011616ecf439e01b9d265e4e98ad279362fcf333f5b057b8efd9d494eac67c76a492cf81caaee482af7b939ddec0ab56c6d38c4369f1f2b470bf3a9d08cfab8a495c950f7ba539930c96ac2fe1a1ba9114cb4577acd6318eb312525dd5b8e2c9a988ad94642cb1e71896f1870fb7b49b70535f18e48b6beb0f5fdb171be559fe4bc78ecffe36770000cb939007c61bacef9b55e0001af357e96ff073e952bc813c5aa9e4b2179194ec4e9392d6c339a7861bb7b5c8e7e66e98492c43ec66b757e5b8151fcc54f784cbd322f3d66574e286f2317379b4e02870f818f83378a07d042c5ec680046a4e6ff0809c9e3660269f813d8c2574972abaf3d56aee2dd0207f8a51d443b0defa19db0b9aea4a6500ce672851d5f55feea42bbabe50ae3a2a2b13ede7a38dee259c7e76d220d8e8f9fd7ba713481ecf9b490252021eb8ed20b535c94c9f5d1d5a0963ae1e4867e495e399e5ad7f88847a08d3eb8a86b2825c2258726de258100f84d7c362a4705abf7a4eafa5ab29e4570a317c4db5293333b07b55c792ac3acfb95e4378524f6629b0db4bdc8756c5b9718eeb036c1fd5f56e9e724439b7b7ef02a6be2408e732ea1b49b3e9b3764ce0aa91bd26a135feccd5a9aadb0414f17e46d768bc035bec9b937177679a1eedc9852bf32e737f8b14b8080615bd686adb60cac6ee96fc379a84159c9c23519c9c146b4b186bdc231e5c7fee999fb6c8e3f59d8af852f75e89627911ec94609918dc514a020afa173f3ae22ba79da71b09ecb1fe90ae26f20703d0ed451f607796a63d6c6e030f7a43f46e91904641564fe76df519c17d030bc07f69ccec7d0903644e29aada18e2856d91e53c3e9c601903d3eac2a0570da4b32ab49bd4ab997f1a64b57ef1b042d8c4066a77cb3600e49a8316006689d8c8b56dc3eca693fa3f133bc6117d867217ea9043c66478d1f067dcf07e35cc60280f4fb964c4cf33b2403a237cfa3d54e5d1d0b4a460240f10d7b11eae29e057b3a2d4e6b90a7b5ff434309734309fdb2c382b0be295e2ddd23c42e7c8af8b6e5ffbf66074e2e73510605d4d05daca5e0ef03dbcc81e78973ac0196872ba4767d0cc6283e6eee82105a368a0fd32895740fd9cda0cde4a595e3f0ea106e486fe55eac4e143be9ad3194650be1e31b8fc15d814e9bec4e9a12a6230e2cd18da170cccad70d015c3d4d666f04eda26b9c435d3a5caf9936560b6678b60395050091c2f44f8f112c08b88847d6e72975ae3db03d82023ff663e8b12aa64f17c91d2b9530741215108ccd95e86c34c063fa3b412dbff5b2c2ff8da4173eccf1eb6e79f509736f208c4370d7cc6cbd583845c66543d4c1f6d441376c445e6087e8c2358aa936b3b05834b52da0f27425aa9f300a584f2b597988ee8c38e6f68c09739e358f7071167dcf47a49de8c92e78a95ca98b6397570956deaa2774f32fa1d9b151db32314bda59a067d4442a695b14d299d7459a4c2e33101d11e96459b860d2a4c9eb84007137fa2e36df6cde95feee6a784920bc3b65b4e228cd8db1c92831a3c9c644a7066d696356fa24a46128c7eb2207578704ba823a9f8fafa9bf03840e94f34debf7f2b7e766b76ddc3257a5d7a16f950297d64228a479dcdcb240894685963b1e0ffdf21aa499be1734cb36616b4d3b93b4b62f49e89efec60f11d456e19c246ab58903777a2b18a337da784522318af36fe93078cd9e632e88653182d6545868e1ece08230343315fcfdbfeaa24a8d02d5064ba5bb9eaf7fe67a8747f2a9a6ba0d5d1fef59e4927de562664c66c0e5a4ab05555c5fb972d3a10758ea26a4d3e87d1fa596b350e30376c2ecdcf69598d743f89767e54195e4b29750848e05d6208613c8838f32546586fec6c4b26be8e675029266b139a833085ffd4de35019db60cd1f57aa2128731d724cd1e595769b2440dc35f3ffcc3a7416a7e98ff88ead5d8e0107957f1ff1c2072ce3a6a8203d70b22ababb5629e6c0ee52d5fa4d98e0473259e3f96e7e9d76460feb90496febe9d52e78fe516ed0623c76d5ac7e06d7bca56ed357d7e3878219aa080587614beb0f1505516c851d3b4ccbeabfac0b6aa4edf166566aa099b70dc7d150b4b3b1916f2b0f22b1394311b7b2554284b0c097eb38aeae50678a8643d7651e8983f8f6020c2c86068fb9ad0e58d4df9cf42233832c20332d189aceb5387151fc31bc9163265020ad15f589c22441df644e22e89b3ed0532bd1546c439bdbb7d591727d54583224d8d8d81303b1281cce0ad8c131c70ce51c94004d5c4c14b15bc10c950dfa05ae636f108fd42e3f69f91ba89364c878cf098b8e2ddc7e0c3d298c2f9841d27b41e6d189ca0cd0f1d55925976a740c70ace64829e29072a00322a6176e7b195ca9639bc0079891ff4c21373e9272604b59a513da48e244be5daaa3750a7af26f6eed8cba4b7ec8ae864c994692697c66440344c6b5635ab1419a6b0a327f6f0b4456888b943f57e87da3b0ee3676c521a826922c67416090011116be00d8720e422f01a0c7c37b6bdce253af76552f57d79f8263abf847aa9e8b520bb26a4679e895216e7241a33c5095bda59d65036142d4aaad1629f48fc0cc3213a8f644b30c204a2c746144c8bf0537a638c520d7be246014dbb61944f089", 16)
                .multiply(new BigInteger("20ad96e3aca74d1b6854e4867ce704b3de5800f9497a5972f66c56f4faf4086f77bd4c680f1340c4e12dc54d804233a0f4368aeebfcd3841a33d2267af1d98bdea1c97c1c6f1fe26cd084a46499f865c391df232380f19ab9022508d5cc3a08c3521904f9503779056fea0717b5fe7e9b5e23e3134b97c9cd02c7be88c2cfa36f4c4175c0895858ebebd8a3ae12522326c0409f2687d4304867c368bd22ad77fc33970256ba5833aa372457c145b4e22515c53f1e125f3de5b8dba631cdb76b66d966500e28102fecd10ce0c7de7b4b17d32ca90bb906c34d64fed116db58d3f667c3bccece9a814280d6b741ee93bb7e352e81029267b6577c643a54c778e4306bf81e301f44a3952dc9f80184f92fa2d3d66a7fe398f0e5dd486edc3b3051433f6daf18aa6cb0527e59767dc5d6c2705e8049e698c57f", 16));
        b2 = big("b2de14ec2ee993ba535d885545df0baf38f4c78390bb0a92ece9259243234dee3f2842d45330073a4c6689b7f8559163ab9426a72b8d840d7b3d212e22047ab39339c49ed377f5d420e7eed6c4f1851057420359d8a5cb4b2cb8289eba16ad1d4a955e734906260929684f4aaf5993fa4d7de1e993cc19714e81b4fda93c55c728be745a112233de6d9b5d3bc9824af6dbf62c35854b1f19f936d0b0a33602aed41f396590127037b9283bbba1f392f67a4f10b750dd73aec210a46509df5dd3ed708ba8beb7503fbdccdc3e71bc65cbe9daaf5d115df6f7e0fc5ded1c6d9987fd635169135042a995c0a85f5a359478daa41331ede052bbfa2829283777d9503f1b672e70794c04d863304e509720896bef9d78a264a6ad1d106aac87715d7a653894bc1ed62f2503d0f471a6b1b9a81d9b2b28ae7a975efea557bd3f49a440144365d89fb909609ff980e9976eb9fe31ffa504bfec651e2966c4e42e3955a9afc09fda96892f326ad1404359b2c3fb0349c74548a39a92326e880b158846f97091345da31779f4033d857e12d564db60b90be31fb7bf516ac22cfd8e43781b288514407cdcfc9c681c2ef3f4a9267542d4166168dc70cd1218b25b0e741ab96b21ef52099e5881f20b9811bd5e65727afa6451e2e9cb9dd6919e0e4465b6d6a4abb14156ef3823c5f8b05a9bfe907188e7f63c46eb94635bdf29060eb2cdd9d692f9e3c7001002f7bb2c8b5d9e7891d8175377b05ad55a279755c9e37da820fe6a387a5efbea8617fbe7c7a30b734272aa95fb011616ecf439e01b9d265e4e98ad279362fcf333f5b057b8efd9d494eac67c76a492cf81caaee482af7b939ddec0ab56c6d38c4369f1f2b470bf3a9d08cfab8a495c950f7ba539930c96ac2fe1a1ba9114cb4577acd6318eb312525dd5b8e2c9a988ad94642cb1e71896f1870fb7b49b70535f18e48b6beb0f5fdb171be559fe4bc78ecffe36770000cb939007c61bacef9b55e0001af357e96ff073e952bc813c5aa9e4b2179194ec4e9392d6c339a7861bb7b5c8e7e66e98492c43ec66b757e5b8151fcc54f784cbd322f3d66574e286f2317379b4e02870f818f83378a07d042c5ec680046a4e6ff0809c9e3660269f813d8c2574972abaf3d56aee2dd0207f8a51d443b0defa19db0b9aea4a6500ce672851d5f55feea42bbabe50ae3a2a2b13ede7a38dee259c7e76d220d8e8f9fd7ba713481ecf9b490252021eb8ed20b535c94c9f5d1d5a0963ae1e4867e495e399e5ad7f88847a08d3eb8a86b2825c2258726de258100f84d7c362a4705abf7a4eafa5ab29e4570a317c4db5293333b07b55c792ac3acfb95e4378524f6629b0db4bdc8756c5b9718eeb036c1fd5f56e9e724439b7b7ef02a6be2408e732ea1b49b3e9b3764ce0aa91bd26a135feccd5a9aadb0414f17e46d768bc035bec9b937177679a1eedc9852bf32e737f8b14b8080615bd686adb60cac6ee96fc379a84159c9c23519c9c146b4b186bdc231e5c7fee999fb6c8e3f59d8af852f75e89627911ec94609918dc514a020afa173f3ae22ba79da71b09ecb1fe90ae26f20703d0ed451f607796a63d6c6e030f7a43f46e91904641564fe76df519c17d030bc07f69ccec7d0903644e29aada18e2856d91e53c3e9c601903d3eac2a0570da4b32ab49bd4ab997f1a64b57ef1b042d8c4066a77cb3600e49a8316006689d8c8b56dc3eca693fa3f133bc6117d867217ea9043c66478d1f067dcf07e35cc60280f4fb964c4cf33b2403a237cfa3d54e5d1d0b4a460240f10d7b11eae29e057b3a2d4e6b90a7b5ff434309734309fdb2c382b0be295e2ddd23c42e7c8af8b6e5ffbf66074e2e73510605d4d05daca5e0ef03dbcc81e78973ac0196872ba4767d0cc6283e6eee82105a368a0fd32895740fd9cda0cde4a595e3f0ea106e486fe55eac4e143be9ad3194650be1e31b8fc15d814e9bec4e9a12a6230e2cd18da170cccad70d015c3d4d666f04eda26b9c435d3a5caf9936560b6678b60395050091c2f44f8f112c08b88847d6e72975ae3db03d82023ff663e8b12aa64f17c91d2b9530741215108ccd95e86c34c063fa3b412dbff5b2c2ff8da4173eccf1eb6e79f509736f208c4370d7cc6cbd583845c66543d4c1f6d441376c445e6087e8c2358aa936b3b05834b52da0f27425aa9f300a584f2b597988ee8c38e6f68c09739e358f7071167dcf47a49de8c92e78a95ca98b6397570956deaa2774f32fa1d9b151db32314bda59a067d4442a695b14d299d7459a4c2e33101d11e96459b860d2a4c9eb84007137fa2e36df6cde95feee6a784920bc3b65b4e228cd8db1c92831a3c9c644a7066d696356fa24a46128c7eb2207578704ba823a9f8fafa9bf03840e94f34debf7f2b7e766b76ddc3257a5d7a16f950297d64228a479dcdcb240894685963b1e0ffdf21aa499be1734cb36616b4d3b93b4b62f49e89efec60f11d456e19c246ab58903777a2b18a337da784522318af36fe93078cd9e632e88653182d6545868e1ece08230343315fcfdbfeaa24a8d02d5064ba5bb9eaf7fe67a8747f2a9a6ba0d5d1fef59e4927de562664c66c0e5a4ab05555c5fb972d3a10758ea26a4d3e87d1fa596b350e30376c2ecdcf69598d743f89767e54195e4b29750848e05d6208613c8838f32546586fec6c4b26be8e675029266b139a833085ffd4de35019db60cd1f57aa2128731d724cd1e595769b2440dc35f3ffcc3a7416a7e98ff88ead5d8e0107957f1ff1c2072ce3a6a8203d70b22ababb5629e6c0ee52d5fa4d98e0473259e3f96e7e9d76460feb90496febe9d52e78fe516ed0623c76d5ac7e06d7bca56ed357d7e3878219aa080587614beb0f1505516c851d3b4ccbeabfac0b6aa4edf166566aa099b70dc7d150b4b3b1916f2b0f22b1394311b7b2554284b0c097eb38aeae50678a8643d7651e8983f8f6020c2c86068fb9ad0e58d4df9cf42233832c20332d189aceb5387151fc31bc9163265020ad15f589c22441df644e22e89b3ed0532bd1546c439bdbb7d591727d54583224d8d8d81303b1281cce0ad8c131c70ce51c94004d5c4c14b15bc10c950dfa05ae636f108fd42e3f69f91ba89364c878cf098b8e2ddc7e0c3d298c2f9841d27b41e6d189ca0cd0f1d55925976a740c70ace64829e29072a00322a6176e7b195ca9639bc0079891ff4c21373e9272604b59a513da48e244be5daaa3750a7af26f6eed8cba4b7ec8ae864c994692697c66440344c6b5635ab1419a6b0a327f6f0b4456888b943f57e87da3b0ee3676c521a826922c67416090011116be00d8720e422f01a0c7c37b6bdce253af76552f57d79f8263abf847aa9e8b520bb26a4679e895216e7241a33c5095bda59d65036142d4aaad1629f48fc0cc3213a8f644b30c204a2c746144c8bf0537a638c520d7be246014dbb61944f089", 16)
                .multiply(big("20ad96e3aca74d1b6854e4867ce704b3de5800f9497a5972f66c56f4faf4086f77bd4c680f1340c4e12dc54d804233a0f4368aeebfcd3841a33d2267af1d98bdea1c97c1c6f1fe26cd084a46499f865c391df232380f19ab9022508d5cc3a08c3521904f9503779056fea0717b5fe7e9b5e23e3134b97c9cd02c7be88c2cfa36f4c4175c0895858ebebd8a3ae12522326c0409f2687d4304867c368bd22ad77fc33970256ba5833aa372457c145b4e22515c53f1e125f3de5b8dba631cdb76b66d966500e28102fecd10ce0c7de7b4b17d32ca90bb906c34d64fed116db58d3f667c3bccece9a814280d6b741ee93bb7e352e81029267b6577c643a54c778e4306bf81e301f44a3952dc9f80184f92fa2d3d66a7fe398f0e5dd486edc3b3051433f6daf18aa6cb0527e59767dc5d6c2705e8049e698c57f", 16));
        assertEquals(b1.toString(16), b2.toString(16));
        b1 = new BigInteger("ee48e04b60b1b6398431f92bbbca5854c362350178ab0ae223d7e540e1d579a9bed874f0109bbec81b7cd73ce1d6265d824d503c32fefac9970951a0a309413a5673ba26c6d4dc77307cb27da288a3bd3965a9622157f42fdd898df7d555c6de43bca498edb9029c6346427a7f1de5643859ca8410c5c6a8c9f42f7bcf7237129d29741810cc15400a04781fafeb7eca036c59e38a47d12c361530a54fc584ee48e53cbd6ec1f50dbdd2dafd581608b7028662c6f9f0a070a08be2d7f817a1b14181afb12513768a9d4aaa37e8f2c258e7ff06ef2802fa58817bcf340a0121f81f9d3c59ad979eb10697dbe8121767695bbc8e270fd67cca90397a0e109d343319ed808069d3a81e8dcc56397f82985e378a5c1407b7b184fa5def2e6a0479944fe3bd42b107ca38ce01f55272d7dcc83783a5ab9d6e0012997dd14c44a22264892919f6bc808f9bfa12602b7a04f353b7fca2f6b3a6d83ad8598496c7163c095023658beabf8a27d63275ca5e7ca47844fb7cf8debd149d8d094ffcdbcd3cf44ae8b65e50902d308f198aef6643a8ed21ee74d9fbd2dfa014", 16)
                .multiply(new BigInteger("520a8d60262973429eb1eff794126b24ad2224aabbfb984c934db25261bffabd391c5e88d7e2f5ee486f984ebad1440cdd4cf9d9778b2e34a296fb76404d1dfc88fc0f50548c6a20b123d708d67d1bf188118858ac04e63f344b92ef687e5fc7533c1c2a502b4e98c18af399bd52bcc95b29d70086d30e1734dd8bd870d891e9913fcd312b63779fa76fe2a791bead0880dfeaad64c6aa3902b8e0384d266f13d8c3cf9a815195651e717041bd83f4cd24a04e679718195e920887f14ddf2d1a731b629d164ad2acb1dbcd83712051129432e92d85d92491563cb88610b77d4ff0ca654abcdb5888082927c594446d1e0f1220e3fb47c6028d036680a318c0bf52a2903f8d5fd0a0778cf1dad0db62da9ddeb60cb99b1c4b4cef1bc4fdd1407f6bcdc7b763bb927f4a3421ce10ac9e89589a2f8d8de44ae99f2db6b8866382685d548456b620aeb615f8eb8c2096b35b50025cdbeffc4f3833eee823c88a1aee2f27a20e6a913c51a71feb763eae2d0935818a83986878811b54205f6f7181617a245cff153684122b033108031fe061c443537e219a2a214d38b202be637bdf5efa4a6cd6a1b3b646a1ba1894fa8c9fb", 16));
        b2 = big("ee48e04b60b1b6398431f92bbbca5854c362350178ab0ae223d7e540e1d579a9bed874f0109bbec81b7cd73ce1d6265d824d503c32fefac9970951a0a309413a5673ba26c6d4dc77307cb27da288a3bd3965a9622157f42fdd898df7d555c6de43bca498edb9029c6346427a7f1de5643859ca8410c5c6a8c9f42f7bcf7237129d29741810cc15400a04781fafeb7eca036c59e38a47d12c361530a54fc584ee48e53cbd6ec1f50dbdd2dafd581608b7028662c6f9f0a070a08be2d7f817a1b14181afb12513768a9d4aaa37e8f2c258e7ff06ef2802fa58817bcf340a0121f81f9d3c59ad979eb10697dbe8121767695bbc8e270fd67cca90397a0e109d343319ed808069d3a81e8dcc56397f82985e378a5c1407b7b184fa5def2e6a0479944fe3bd42b107ca38ce01f55272d7dcc83783a5ab9d6e0012997dd14c44a22264892919f6bc808f9bfa12602b7a04f353b7fca2f6b3a6d83ad8598496c7163c095023658beabf8a27d63275ca5e7ca47844fb7cf8debd149d8d094ffcdbcd3cf44ae8b65e50902d308f198aef6643a8ed21ee74d9fbd2dfa014", 16)
                .multiply(big("520a8d60262973429eb1eff794126b24ad2224aabbfb984c934db25261bffabd391c5e88d7e2f5ee486f984ebad1440cdd4cf9d9778b2e34a296fb76404d1dfc88fc0f50548c6a20b123d708d67d1bf188118858ac04e63f344b92ef687e5fc7533c1c2a502b4e98c18af399bd52bcc95b29d70086d30e1734dd8bd870d891e9913fcd312b63779fa76fe2a791bead0880dfeaad64c6aa3902b8e0384d266f13d8c3cf9a815195651e717041bd83f4cd24a04e679718195e920887f14ddf2d1a731b629d164ad2acb1dbcd83712051129432e92d85d92491563cb88610b77d4ff0ca654abcdb5888082927c594446d1e0f1220e3fb47c6028d036680a318c0bf52a2903f8d5fd0a0778cf1dad0db62da9ddeb60cb99b1c4b4cef1bc4fdd1407f6bcdc7b763bb927f4a3421ce10ac9e89589a2f8d8de44ae99f2db6b8866382685d548456b620aeb615f8eb8c2096b35b50025cdbeffc4f3833eee823c88a1aee2f27a20e6a913c51a71feb763eae2d0935818a83986878811b54205f6f7181617a245cff153684122b033108031fe061c443537e219a2a214d38b202be637bdf5efa4a6cd6a1b3b646a1ba1894fa8c9fb", 16));
        assertEquals(b1.toString(16), b2.toString(16));

        SecureRandom random = new SecureRandom();
        long time = System.currentTimeMillis();
        for (int i = 0; i < 500; i++) {
            BigInteger a = new BigInteger(4000 + random.nextInt(2000), random).abs();
            BigInteger b = new BigInteger(4000 + random.nextInt(2000), random).abs();
            BigInteger c = a.multiply(b);
            assertEquals(a.toString(16) + " x " + b.toString(16), c.toString(16), big(a.toString()).multiplyToomCook3(big(b.toString())).toString(16));
        }
        System.out.println(System.currentTimeMillis() - time);
    }

    @Test
    public void test_false_positives() {
        // false-positive reported at http://www.gnu.org/software/gnu-crypto/primes-note.html
        Scanner primes = new Scanner(getClass().getResourceAsStream("/primes.txt"));
        while (primes.hasNext()) {
            String prime = primes.next();
            System.out.println("PRIME: " + prime);
            System.out.println(" - JDK7: " + new BigInteger(prime, 16).isProbablePrime(50));
            System.out.println(" - JDK6: " + new java.math.BigInteger(prime, 16).isProbablePrime(50));
            System.out.println(" - LucasLehmer: " + big(prime, 16).isPrimeLucasLehmer());
            System.out.println(" - FermatLittle: " + big(prime, 16).isPrimeFermatLittle());
            System.out.println(" - MillerRabin: " + big(prime, 16).isPrimeMillerRabin());
            System.out.println(" - SolovayStrassen: " + big(prime, 16).isPrimeSolovayStrassen());
            System.out.println(" - EulerCriterion: " + big(prime, 16).isPrimeEulerCriterion());

        }
        primes = new Scanner(getClass().getResourceAsStream("/primes.txt"));
        while (primes.hasNext()) {
            String prime = primes.next();
            assertTrue(new BigInteger(prime, 16).isProbablePrime(50));
            assertTrue(new java.math.BigInteger(prime, 16).isProbablePrime(50));
            assertTrue(big(prime, 16).isPrimeLucasLehmer());
            assertTrue(big(prime, 16).isPrimeFermatLittle());
            assertTrue(big(prime, 16).isPrimeMillerRabin());
            assertTrue(big(prime, 16).isPrimeSolovayStrassen());
            assertTrue(big(prime, 16).isPrimeEulerCriterion());
        }
    }

    @Test
    public void test_isEulerJacobiPseudoprime() {
        assertTrue(big(561).isPseudoprimeEulerJacobi(big(2)));
        assertTrue(big(2465).isPseudoprimeEulerJacobi(big(61)));
        assertTrue(big(1309).isPseudoprimeEulerJacobi(big(67)));
        assertFalse(big(1309).isPseudoprimeEulerJacobi(big(61)));
    }

    @Test
    public void test_isPrimeSolovayStrassen() {
        assertFalse(ZERO.isPrimeSolovayStrassen());
        assertFalse(ONE.isPrimeSolovayStrassen());
        assertTrue(TWO.isPrimeSolovayStrassen());
        assertTrue(big(7).isPrimeSolovayStrassen());
        assertTrue(big(179).isPrimeSolovayStrassen());
        assertTrue(big(Integer.MAX_VALUE).isPrimeSolovayStrassen());
        assertTrue(big(Integer.MAX_VALUE).nextPrime().nextPrime().isPrimeSolovayStrassen());
        // Test some Carmichael numbers
        assertFalse(big(561).isPrimeSolovayStrassen());
        assertFalse(big(1105).isPrimeSolovayStrassen());
        assertFalse(big(1729).isPrimeSolovayStrassen());
        assertFalse(big(2100901).isPrimeSolovayStrassen());
        for (int p : Sieve.to(10000).asArray())
            assertTrue(big(p).isPrimeSolovayStrassen());
    }

    @Test
    public void test_isPrimeFermatLittle() {
        assertFalse(ZERO.isPrimeFermatLittle());
        assertFalse(ONE.isPrimeFermatLittle());
        assertTrue(TWO.isPrimeFermatLittle());
        assertTrue(big(7).isPrimeFermatLittle());
        assertTrue(big(179).isPrimeFermatLittle());
        assertTrue(big(Integer.MAX_VALUE).isPrimeFermatLittle());
        assertTrue(big(Integer.MAX_VALUE).nextPrime().nextPrime().isPrimeFermatLittle());
        // Test some Carmichael numbers 
        assertFalse(big(561).isPrimeFermatLittle());
        assertFalse(big(1105).isPrimeFermatLittle());
        assertFalse(big(1729).isPrimeFermatLittle());
        assertFalse(big(2100901).isPrimeFermatLittle());
    }

    @Test
    public void test_isPandigital() {
        assertTrue(big(932718654).isPandigital(1, 9));
        assertTrue(big(9327186540L).isPandigital());
        assertTrue(big(93271888654000L).isPandigital());
        assertFalse(big(33).isPandigital(1, 9));
        assertTrue(big(123456789).isPandigital(1, 9));
        assertTrue(big(946138257).isPandigital(1, 9));
        assertTrue(big(1234).isPandigital(1, 4));
        assertFalse(big(1244).isPandigital(1, 4));
        assertFalse(big(946108257).isPandigital(1, 9));
        assertTrue(big(1234567899).isPandigital(1, 9));
        assertFalse(big(1234567899).isPandigital());
        assertFalse(big(100).isPandigital(1, 2));
        assertTrue(big(100).isPandigital(0, 1));
        assertTrue(big(100).toRadix(2).isPandigital());
        assertTrue(big(120).isPandigital(0, 2));
        assertTrue(big(342).isPandigital(2, 4));
    }

    @Test
    public void test_range() {
        assertArrayEquals(big(0).pandigitalRange(), new byte[]{0, 0});
        assertArrayEquals(big(1).pandigitalRange(), new byte[]{1, 1});
        assertArrayEquals(big(57603421).pandigitalRange(), new byte[]{0, 7});
        assertArrayEquals(big(5763421).pandigitalRange(), new byte[]{1, 7});
        assertArrayEquals(big(10).pandigitalRange(), new byte[]{0, 1});
        assertArrayEquals(big(23459).pandigitalRange(), null);
        assertArrayEquals(big(9876543210L).pandigitalRange(), new byte[]{0, 9});
    }

    @Test
    public void test_jacobiSymbol() throws Exception {
        Random r = new SecureRandom();

        assertEquals(BigInteger.jacobiSymbol(79, BigInteger.valueOf(3)), 1);
        assertEquals(big(3).jacobiSymbol(big(79)), ONE);

        assertEquals(BigInteger.jacobiSymbol(5, BigInteger.valueOf(7)), -1);
        assertEquals(big(7).jacobiSymbol(big(5)), ONE.opposite());

        assertEquals(BigInteger.jacobiSymbol(81, BigInteger.valueOf(7)), 1);
        assertEquals(big(7).jacobiSymbol(big(81)), ONE);

        assertEquals(BigInteger.jacobiSymbol(691385, BigInteger.valueOf(9)), 1);
        assertEquals(big(9).jacobiSymbol(big(691385)), ONE);

        assertEquals(0, BigInteger.jacobiSymbol(26970, BigInteger.valueOf(9)));
        assertEquals(ZERO, big(9).jacobiSymbol(big(26970)));

        for (int i = 3; i < 100000; i += 2) {
            int a = r.nextInt(1000001);
            assertEquals("(" + a + "/" + i + ")",
                    big(BigInteger.jacobiSymbol(a, BigInteger.valueOf(i))),
                    big(i).jacobiSymbol(big(a)));
        }
    }

    @Test
    public void test_falling() {
        assertEquals(big(0).factorialFalling(0), big(1));
        assertEquals(big(1).factorialFalling(1), big(1));
        assertEquals(big(2).factorialFalling(1), big(2));
        assertEquals(big(20).factorialFalling(10), big(670442572800L));
    }

    @Test
    public void sumTo() {
        assertEquals(big(6).sumTo(3), big(3).sumTo(6));
        assertEquals(big(6).sumTo(3), big(18));
        assertEquals(big(1).sumTo(10), big(55));
    }

    @Test
    public void productTo() {
        assertEquals(big(6).productTo(3), big(3).productTo(6));
        assertEquals(big(6).productTo(3), big(360));
        assertEquals(big(1).productTo(10), big(3628800));
    }

    @Test
    public void recurringCycle() {
        assertArrayEquals(TWO.recuringCycle(), new BigInt[]{ZERO, ZERO});
        assertArrayEquals(big(983).recuringCycle(), new BigInt[]{big("0010172939979654120040691759918616480162767039674465920651068158697863682604272634791454730417090539165818921668362156663275686673448626653102746693794506612410986775178026449643947100712105798575788402848423194303153611393692777212614445574771108850457782299084435401831129196337741607324516785350966429298067141403865717192268565615462868769074262461851475076297049847405900305188199389623601220752797558494404883011190233977619532044760935910478128179043743641912512716174974567650050864699898270600203458799593082400813835198372329603255340793489318413021363173957273652085452695829094608341810783316378433367243133265513733468972533062054933875890132248219735503560528992878942014242115971515768056968463886063072227873855544252288911495422177009155645981688708036622583926754832146490335707019328585961342828077314343845371312309257375381485249237029501525940996948118006103763987792472024415055951169888097660223804679552390640895218718209562563580874872838250254323499491353"), big(982)});
        assertArrayEquals(big(5).recuringCycle(), new BigInt[]{ZERO, ZERO});
        assertArrayEquals(big(3).recuringCycle(), new BigInt[]{big(3), ONE});
    }

    @Test
    public void test_euclid_extended() {
        assertEquals(Arrays.toString(big(13).euclidExtended(big(168))), "[13, -1, 1]");
        assertEquals(Arrays.toString(big(17).euclidExtended(big(352))), "[145, -7, 1]");
        assertEquals(Arrays.toString(big(31).euclidExtended(big(4864))), "[-1569, 10, 1]");
        BigInt[] abc = big(123456789).euclidExtended(big(987654321));
        assertEquals(abc[0], big(-8));
        assertEquals(abc[1], big(1));
        assertEquals(abc[2], big(9));
        assertEquals(abc[2], big(123456789).gcd(big(987654321)));
        assertEquals(big(123456789).multiply(abc[0]).add(big(987654321).multiply(abc[1])), abc[2]);
    }

    @Test
    public void test_modInverse() {
        System.out.println(BigInteger.valueOf(13).modInverse(BigInteger.valueOf(168)));
        System.out.println(BigInteger.valueOf(17).modInverse(BigInteger.valueOf(352)));
        System.out.println(BigInteger.valueOf(31).modInverse(BigInteger.valueOf(4864)));
        System.out.println(BigInteger.valueOf(-45).modInverse(BigInteger.valueOf(4864)));
        System.out.println(BigInteger.valueOf(-31).modInverse(BigInteger.valueOf(3675)));
        assertEquals(big(13).modInverse(big(168)).toString(), "13");
        assertEquals(big(17).modInverse(big(352)).toString(), "145");
        assertEquals(big(31).modInverse(big(4864)).toString(), "3295");
        assertEquals(big(-31).modInverse(big(3675)).toString(), "1304");
        assertEquals(big(-45).modInverse(big(4864)).toString(), "3675");

        Random r = new SecureRandom();
        for (int i = 1; i < 1000;) {
            try {
                BigInteger x = BigInteger.valueOf(i);
                BigInteger m = new BigInteger(10, r);
                BigInteger inv = x.modInverse(m);
                BigInteger prod = inv.multiply(x).remainder(m);
                if (prod.signum() == -1) prod = prod.add(m);
                if (prod.equals(BigInteger.ONE))
                    assertEquals(big(x.toString()).modInverse(big(m.toString())), big(inv.toString()));
                i++;
            } catch (ArithmeticException e) {
            }
        }
    }

    @Test
    public void test_mod() {
        assertEquals(big(Long.MAX_VALUE).mod(Long.MAX_VALUE), big(0));
        assertEquals(big(Long.MAX_VALUE).add(1).mod(Long.MAX_VALUE), big(1));
        assertEquals(big(Long.MAX_VALUE).subtract(1).mod(Long.MAX_VALUE), big(9223372036854775806L));
        assertEquals(big(Long.MAX_VALUE).add(12345).mod(Long.MAX_VALUE), big(12345));
        assertEquals(big(Long.MAX_VALUE).add(Long.MAX_VALUE).mod(Long.MAX_VALUE), big(0));
        assertEquals(big(Long.MAX_VALUE).square().mod(Long.MAX_VALUE), big(0));
    }

    @Test
    public void test_gcd() {
        assertEquals(big(644).gcd(big(645)), big(1));
        assertEquals(big(1000).gcd(big(100)), big(100));
        assertEquals(big(15).gcd(big(17)), big(1));
        assertEquals(big(15).gcd(big(18)), big(3));
        assertEquals(big(15).gcd(big(18), big(27), big(36), big(20)), big(1));
        assertEquals(big(15).gcd(big(18), big(27), big(36)), big(3));
        assertEquals(big(15).gcd(big(18), big(27)), big(3));
    }

    @Test
    public void test_lcm() {
        assertEquals(big(14).lcm(big(15)), big(210));
        assertEquals(big(15).lcm(big(18), big(27)), big(270));
        assertEquals(big(644).lcm(big(645)), big(415380));
        assertEquals(big(644).lcm(big(646)), big(208012));
    }

    @Test
    public void test_toRadix() {
        assertEquals(big(0).toRadix(8).toString(), "0");
        assertEquals(big(1).toRadix(8).toString(), "1");
        assertEquals(big(1000000000).toRadix(8).toString(), "7346545000");
        assertEquals(big(-1000000000).toRadix(8).toString(), "-7346545000");
    }

    @Test
    public void test_reverse() {
        assertEquals(big("123456789123456789123456789").digitsReversed(), big("987654321987654321987654321"));
        assertEquals(big(733007751850L).toRadix(2).digitsReversed().toRadix(10).toString(), "366503875925"); // 101010101010101010101010101010101010101
        assertEquals(big("ABCDEF", 16).digitsReversed().toString(), "fedcba"); // 101010101010101010101010101010101010101
    }

    @Test
    public void test_rotate() {
        /*assertEquals(big(1234).digitsRotated(0).toInt(), 1234);
        assertEquals(big(1234).digitsRotated(1).toInt(), 4123);
        assertEquals(big(1234).digitsRotated(2).toInt(), 3412);
        assertEquals(big(1234).digitsRotated(3).toInt(), 2341);
        assertEquals(big(1234).digitsRotated(4).toInt(), 1234);
        assertEquals(big(1234).digitsRotated(5).toInt(), 4123);*/
        assertEquals(big(123456).digitsRotated(3).toInt(), 456123);
        assertEquals(big(123456).digitsRotated(2).toInt(), 561234);
        assertEquals(big(1234567).digitsRotated(3).toInt(), 5671234);
        assertEquals(big(1234).digitsRotated(-1).toInt(), 2341);
        assertEquals(big(1234).digitsRotated(-2).toInt(), 3412);
        assertEquals(big(1234).digitsRotated(-3).toInt(), 4123);
        assertEquals(big(1234).digitsRotated(-4).toInt(), 1234);
        assertEquals(big(1234).digitsRotated(-5).toInt(), 2341);
        assertEquals(big("123456789123456789123456789").digitsRotated(-5), big("678912345678912345678912345"));
    }

    @Test
    public void test_sum() {
        assertEquals(ZERO.digitsSum(), 0);
        assertEquals(ONE.digitsSum(), 1);
        assertEquals(big(9999999999L).digitsSum(), 90);
    }

    @Test
    public void test_length() {
        assertEquals(ZERO.digitsCount(), 1);
        assertEquals(ONE.digitsCount(), 1);
        assertEquals(big(9999999999L).digitsCount(), 10);
        assertEquals(big(10000).digitsCount(), 5);
    }

    @Test
    public void test_list() {
        assertArrayEquals(big(9999999999L).digits(), new byte[]{9, 9, 9, 9, 9, 9, 9, 9, 9, 9});
        assertArrayEquals(big(1234567890).digits(), new byte[]{1, 2, 3, 4, 5, 6, 7, 8, 9, 0});
        assertArrayEquals(big(9999999999L).digits(), new byte[]{9, 9, 9, 9, 9, 9, 9, 9, 9, 9});
        assertArrayEquals(big(1234567890).digits(), new byte[]{1, 2, 3, 4, 5, 6, 7, 8, 9, 0});
        long time = System.currentTimeMillis();
        for (int j = 2; j < 11; j++)
            for (long i = 10000000000L; i < 10000100000L; i++)
                big(i).digits();
        System.out.println(System.currentTimeMillis() - time);
    }

    @Test
    public void test_sort() {
        assertEquals(big(733007751850L).toRadix(2).digitsSorted().toRadix(10).toString(), "1048575"); // == 11111111111111111111
        assertEquals(big(1234567890L).digitsSorted().toString(), "123456789");
        assertEquals(big(9876543210L).digitsSorted().toString(), "123456789");
    }

    @Test
    public void test_digitalRoot() {
        for (int i = 0; i < 10; i++)
            assertEquals(big(i).digitalRoot(), i);
        assertEquals(big(65536).digitalRoot(), 7);
        assertEquals(big(0).digitalRoot(), 0);
        assertEquals(big(Long.MAX_VALUE).digitalRoot(), 7);
    }

    @Test
    public void test_signature() {
        assertArrayEquals(big(733007751850L).toRadix(2).digitsSignature(), new byte[]{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1});
        assertArrayEquals(big(733007751850L).digitsSignature(), new byte[]{0, 0, 0, 1, 3, 3, 5, 5, 7, 7, 7, 8});
    }

    @Test
    public void test_root() {
        assertArrayEquals(big(14).irootAndRemainder(5), new BigInt[]{big(1), big(13)});

        assertArrayEquals(big(Integer.MAX_VALUE).irootAndRemainder(4), new BigInt[]{big(215), big(10733022)});
        assertArrayEquals(big("15241578750190521").irootAndRemainder(2), new BigInt[]{big("123456789"), big(0)});
        assertArrayEquals(big("15241578750190530").irootAndRemainder(2), new BigInt[]{big("123456789"), big(9)});
        assertArrayEquals(big("1881676371789154860897089").irootAndRemainder(3), new BigInt[]{big("123456789"), big(20)});

        assertArrayEquals(big(0).irootAndRemainder(2), new BigInt[]{big(0), big(0)});
        assertArrayEquals(big(1).irootAndRemainder(2), new BigInt[]{big(1), big(0)});
        assertArrayEquals(big(2).irootAndRemainder(2), new BigInt[]{big(1), big(1)});
        assertArrayEquals(big(3).irootAndRemainder(2), new BigInt[]{big(1), big(2)});
        assertArrayEquals(big(3).irootAndRemainder(3), new BigInt[]{big(1), big(2)});
        assertArrayEquals(big(4).irootAndRemainder(2), new BigInt[]{big(2), big(0)});
        assertArrayEquals(big(5).irootAndRemainder(2), new BigInt[]{big(2), big(1)});

        Random m = new Random();
        for (int i = 1; i < 10000; i++) {
            int root = m.nextInt(10) + 1;
            BigInt[] qr = big(i).irootAndRemainder(root);
            assertEquals("" + i, big(i), qr[0].pow(root).add(qr[1]));
        }
    }

    @Test
    public void test_sqrt() {
        assertArrayEquals(big(0).isqrtAndRemainder(), new BigInt[]{big(0), big(0)});
        assertArrayEquals(big(1).isqrtAndRemainder(), new BigInt[]{big(1), big(0)});
        assertArrayEquals(big(2).isqrtAndRemainder(), new BigInt[]{big(1), big(1)});
        assertArrayEquals(big(3).isqrtAndRemainder(), new BigInt[]{big(1), big(2)});
        assertArrayEquals(big("15241578750190521").irootAndRemainder(2), new BigInt[]{big("123456789"), big(0)});
        assertArrayEquals(big("15241578750190530").irootAndRemainder(2), new BigInt[]{big("123456789"), big(9)});
        assertArrayEquals(big(Integer.MAX_VALUE).irootAndRemainder(2), new BigInt[]{big(46340), big(88047)});

        for (int i = 1; i < 10000; i++) {
            BigInt[] qr = big(i).isqrtAndRemainder();
            assertEquals("" + i, big(i), qr[0].square().add(qr[1]));
        }
        for (int i = Integer.MAX_VALUE - 100000; i < Integer.MAX_VALUE; i++) {
            BigInt[] qr = big(i).isqrtAndRemainder();
            assertEquals("" + i, big(i), qr[0].square().add(qr[1]));
        }
        for (long i = Long.MAX_VALUE - 100000; i < Long.MAX_VALUE; i++) {
            BigInt[] qr = big(i).isqrtAndRemainder();
            assertEquals("" + i, big(i), qr[0].square().add(qr[1]));
        }
    }

    @Test
    public void test_millerRabin() {
        assertFalse(ZERO.isPrimeMillerRabin());
        assertFalse(ONE.isPrimeMillerRabin());
        assertTrue(TWO.isPrimeMillerRabin());
        assertTrue(big(7).isPrimeMillerRabin());
        assertTrue(big(179).isPrimeMillerRabin());
        System.out.println(BigInteger.valueOf(Integer.MAX_VALUE).isProbablePrime(100));
        assertTrue(big(Integer.MAX_VALUE).isPrimeMillerRabin());
        assertTrue(big(Integer.MAX_VALUE).nextPrime().nextPrime().isPrimeMillerRabin());
    }

    @Test
    public void test_isPrimeLucasLehmer() {
        assertFalse(ZERO.isPrimeLucasLehmer());
        assertFalse(big(4).isPrimeLucasLehmer());
        assertTrue(TWO.isPrimeLucasLehmer());
        assertTrue(big(3).isPrimeLucasLehmer());
        assertTrue(big(5).isPrimeLucasLehmer());
        assertTrue(big(31).isPrimeLucasLehmer()); // matches 2^31-1 = Integer.MAX_VALUE
        assertTrue(big(Integer.MAX_VALUE).isPrimeLucasLehmer()); // matches 2^31-1 = Integer.MAX_VALUE
        assertTrue(big(Integer.MAX_VALUE).nextPrime().nextPrime().isPrimeLucasLehmer());
        assertTrue(big(Integer.MAX_VALUE).square().nextPrime().nextPrime().isPrimeLucasLehmer());
        for (int p : Sieve.to(10000).asArray())
            assertTrue(big(p).isPrimeLucasLehmer());
    }

    @Test
    public void test_isPrimeMersenne() {
        assertFalse(ZERO.isPrimeMersenne());
        assertFalse(big(4).isPrimeMersenne());
        assertTrue(TWO.isPrimeMersenne());
        assertTrue(big(3).isPrimeMersenne());
        assertTrue(big(5).isPrimeMersenne());
        assertTrue(big(31).isPrimeMersenne()); // matches 2^31-1 = Integer.MAX_VALUE
        assertFalse(big(63).isPrimeMersenne()); // matches 2^63-1 = Long.MAX_VALUE
        assertFalse(big(1023).isPrimeMersenne());
    }

}
